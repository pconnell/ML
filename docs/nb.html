<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploring Protected Classes as Predictors in Mortgage Approval - 7&nbsp; Naive Bayes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./dt.html" rel="next">
<link href="./arm.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./nb.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Naive Bayes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Exploring Protected Classes as Predictors in Mortgage Approval</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/pconnell/ML" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./ML-Final-Report.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Gathering and Exploratory Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Principal Component Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple Correspondence Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Association Rule Mining</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nb.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Naive Bayes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Decision Tree Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Regression Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Data Gathering/Cleaning Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Component Analysis Code (PCA and MCA)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Association Rule Mining Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Naive Bayes Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Decision Tree Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Regression Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app8-mca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Multiple Correspondence Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">7.1</span> Overview</a>
  <ul class="collapse">
  <li><a href="#what-makes-it-naive" id="toc-what-makes-it-naive" class="nav-link" data-scroll-target="#what-makes-it-naive"><span class="header-section-number">7.1.1</span> <em>What makes it Naive?</em></a></li>
  <li><a href="#how-does-it-work" id="toc-how-does-it-work" class="nav-link" data-scroll-target="#how-does-it-work"><span class="header-section-number">7.1.2</span> <em>How does it work?</em></a></li>
  <li><a href="#the-zero-frequency-problem" id="toc-the-zero-frequency-problem" class="nav-link" data-scroll-target="#the-zero-frequency-problem"><span class="header-section-number">7.1.3</span> The Zero-Frequency Problem</a></li>
  <li><a href="#bernoulli-naive-bayes" id="toc-bernoulli-naive-bayes" class="nav-link" data-scroll-target="#bernoulli-naive-bayes"><span class="header-section-number">7.1.4</span> Bernoulli Naive Bayes</a></li>
  </ul></li>
  <li><a href="#data-and-code" id="toc-data-and-code" class="nav-link" data-scroll-target="#data-and-code"><span class="header-section-number">7.2</span> Data and Code</a>
  <ul class="collapse">
  <li><a href="#multinomial-naive-bayes" id="toc-multinomial-naive-bayes" class="nav-link" data-scroll-target="#multinomial-naive-bayes"><span class="header-section-number">7.2.1</span> Multinomial Naive Bayes</a></li>
  <li><a href="#bernoulli-naive-bayes-1" id="toc-bernoulli-naive-bayes-1" class="nav-link" data-scroll-target="#bernoulli-naive-bayes-1"><span class="header-section-number">7.2.2</span> Bernoulli Naive Bayes</a></li>
  <li><a href="#categorical-naive-bayes" id="toc-categorical-naive-bayes" class="nav-link" data-scroll-target="#categorical-naive-bayes"><span class="header-section-number">7.2.3</span> Categorical Naive Bayes</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">7.3</span> Results</a>
  <ul class="collapse">
  <li><a href="#categorical-naive-bayes-1" id="toc-categorical-naive-bayes-1" class="nav-link" data-scroll-target="#categorical-naive-bayes-1"><span class="header-section-number">7.3.1</span> Categorical Naive Bayes</a></li>
  <li><a href="#multinomial-naive-bayes-1" id="toc-multinomial-naive-bayes-1" class="nav-link" data-scroll-target="#multinomial-naive-bayes-1"><span class="header-section-number">7.3.2</span> Multinomial Naive Bayes</a></li>
  <li><a href="#bernoulli-naive-bayes-2" id="toc-bernoulli-naive-bayes-2" class="nav-link" data-scroll-target="#bernoulli-naive-bayes-2"><span class="header-section-number">7.3.3</span> Bernoulli Naive Bayes</a></li>
  <li><a href="#overall" id="toc-overall" class="nav-link" data-scroll-target="#overall"><span class="header-section-number">7.3.4</span> Overall</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-NB" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Naive Bayes</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<!-- 
Rubric Items
* Naïve Bayes’ (NB) overview
The Multinomial NB algorithm is explained well enough that a novice can get a good idea of how the model is trained and makes predictions. Goes into why smoothing is required for NB models. Also defines and describes Bernoulli NB. Images that you think explain the model are included.

* Link and image of the sample train and test data to be used. Another image of cleaned data, if the sample data needs to be cleaned further before feeding it to the NB algo. Explains how test train split was created and why it is important to create a disjoint split. Link to code for all of this.

* Discuss and visualize results, including confusion matrix and accuracy. What did you learn about your topic from the results.
-->
<section id="overview" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">7.1</span> Overview</h2>
<p>The Naive Bayes method of classification provides a fairly simple and accessible framework under which to estimate the probability that a subject is a member of a certain class, given prior evidence within one’s dataset. The methodology is commonly used in recommendation systems (e.g.&nbsp;streaming services, online gaming services, e-commerce, and many more) to quickly identify and suggest new actions, items, or activity to a user based on their past actions or activity.<br>
<!-- What does NB do in general? When is it used and why?  --> The simplicity of the algorithm makes it an excellent candidate for assessing categorical data (in the case of multinomial Naive Bayes), as well as normally-distributed numerical data (for Gaussian Naive Bayes), and Bernoulli distributed or binary data (as for Bernoulli Naive Bayes). The assumptions made in the algorithm render it simple to implement, and to produce models with a reliable degree of performance.</p>
<section id="what-makes-it-naive" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="what-makes-it-naive"><span class="header-section-number">7.1.1</span> <em>What makes it Naive?</em></h3>
<p>The following equations outline different formulations of Bayes’ Rule. In these formulations, let X represent the Data, and Y represent the Outcome or Label for the data.</p>
<p><span id="eq-bayes1"><span class="math display">\[
P(X|Y) = \frac{P(Y|X)\cdot P(X)}{P(Y)}
\tag{7.1}\]</span></span></p>
<p><span id="eq-bayes2"><span class="math display">\[
P(X|Y) = \frac{P(X\cap Y)}{P(Y)}
\tag{7.2}\]</span></span></p>
<p><span id="eq-bayes3"><span class="math display">\[
P(Y|X) = \frac{P(X|Y)\cdot P(X)}{P(Y)}
\tag{7.3}\]</span></span></p>
<p><span id="eq-bayes4"><span class="math display">\[
P(Y|X) = \frac{P(X\cap Y)}{P(X)}
\tag{7.4}\]</span></span></p>
<p>Bayes’ rule has no stipulation that X and Y be independent from one another in the source data. The requirement is that the input probability for <span class="math inline">\(P(X)\)</span>, <span class="math inline">\(P(Y)\)</span>, and <span class="math inline">\(P(X\cap Y)\)</span> be the <em>actual</em> probability for each variable or combination thereof.</p>
<p>The algorithm is Naive because it <em>assumes</em> all features or input variables are <em>independent</em> of one another, or that each features’ probability does not directly impact one another. In this assumption, it means one can leverage the probability rule for independence between two variables:</p>
<p><span id="eq-indep"><span class="math display">\[
P(X\cap Y) = P(X)\cdot P(Y)\iff \text{X,Y are independent}
\tag{7.5}\]</span></span></p>
<p>In the world of statistics, it can be quite rare to encounter a collected dataset in which all features are truly independent of one another.</p>
<p>Many novice, introductory statistics students sometimes make the assumption that variables are independent while working out problems in their homeworks, quizzes, or exams. This leads to incorrect responses, but makes the problem doable in relatively short order. In doing so, those students demonstrate their naivety. Since it makes the same assumption and performs no work to confirm or refute the claim, Naive Bayes is similarly naive.</p>
<p>This allows for the transformation of <a href="#eq-bayes3" class="quarto-xref">Equation&nbsp;<span>7.3</span></a>, <a href="#eq-bayes4" class="quarto-xref">Equation&nbsp;<span>7.4</span></a>, and <a href="#eq-indep" class="quarto-xref">Equation&nbsp;<span>7.5</span></a> to calculate probabilites when fitting data to a model and predicting the class of a new record:</p>
<p><span id="eq-naive1"><span class="math display">\[
P(Y|X) = \frac{P(X_1|Y)\cdot P(X_2|Y)\cdot ...\cdot P(X_n|Y)}{P(Y)}
\tag{7.6}\]</span></span></p>
<p><span id="eq-naive2"><span class="math display">\[
P(Y|X) = \frac{P(X_1\cap Y)\cdot P(X_2 \cap Y)\cdot ...\cdot P(X_n\cap Y)}{P(Y)}
\tag{7.7}\]</span></span></p>
<p><span id="eq-naive3"><span class="math display">\[
P(Y|X) = \frac{\prod\limits_{i=1}^n P(X_i\cap Y)}{P(X)}
\tag{7.8}\]</span></span></p>
<p>In <a href="#eq-naive3" class="quarto-xref">Equation&nbsp;<span>7.8</span></a>, one can see that the probability of belonging to a certain class, given an input record, is the product of the probabilities of each individual feature holding the same category for <span class="math inline">\(X_j\)</span> when the class is <span class="math inline">\(Y\)</span>.</p>
<p>Because of the product formulation in <a href="#eq-naive3" class="quarto-xref">Equation&nbsp;<span>7.8</span></a> above, it can be benefical to represent the equation using logarithms, rendering a simpler and more easily calculated implementation:</p>
<p><span id="eq-naive4"><span class="math display">\[
\text{log}(P(Y|X)) = \frac{\text{log}\sum\limits_{i=1}^n P(X_i\cap Y)}{P(X)}
\tag{7.9}\]</span></span></p>
</section>
<section id="how-does-it-work" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="how-does-it-work"><span class="header-section-number">7.1.2</span> <em>How does it work?</em></h3>
<p>In short, prior probabilities are calculated as follows from a training dataset:</p>
<p><span class="math display">\[
P(X|Y) = \frac{P(X\cap Y)}{P(Y)}
\]</span></p>
<p>The above is calculated for all features <span class="math inline">\(X_i\)</span> in <span class="math inline">\(X\)</span>.</p>
<p>From there, these probabilities are applied in <a href="#eq-naive3" class="quarto-xref">Equation&nbsp;<span>7.8</span></a> for every possible class outcome <span class="math inline">\(y_i\)</span>. The maximum amongst these probabilites is selected as the predicted class.</p>
<p>A simple way to understand Naive Bayes is as a calculation of the combined relative frequency for all features or variables in consideration when records belong to a specific class. These relative frequencies are treated as overall probabities, and are pre-calculated for a Naive Bayes model using a training dataset. When new records are introduced to the model for classification, Naive Bayes outputs the class that has the greatest probability using the pre-computed prior probabilites in conjunction with the new records’ feature data.</p>
<p>Consider the below example:</p>
<p>For this example, a dummy dataset is generated with 400 records. There are 4 classifications - R, G, Y, and B. There are 3 features for evaluation:</p>
<ul>
<li><p>size, which takes on possible values of “S”, “M”, or “L”</p></li>
<li><p>cost, which takes on possible values of “free”,“low”,‘medium’, or ‘high’</p></li>
<li><p>tested, which is a boolean - True/False value</p></li>
</ul>
<p>Below are the first 10 records of this dummy dataset:</p>
<div class="cell" data-execution_count="3">
<div id="tbl-rnd-data" class="cell quarto-float anchored" data-execution_count="3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rnd-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.1: randomly generated dataset, first 10 records
</figcaption>
<div aria-describedby="tbl-rnd-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="3">
<style type="text/css">
</style>

<table id="T_076e6" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_076e6_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">class</th>
<th id="T_076e6_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">size</th>
<th id="T_076e6_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">cost</th>
<th id="T_076e6_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">tested</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_076e6_row0_col0" class="data row0 col0">R</td>
<td id="T_076e6_row0_col1" class="data row0 col1">S</td>
<td id="T_076e6_row0_col2" class="data row0 col2">low</td>
<td id="T_076e6_row0_col3" class="data row0 col3">False</td>
</tr>
<tr class="even">
<td id="T_076e6_row1_col0" class="data row1 col0">R</td>
<td id="T_076e6_row1_col1" class="data row1 col1">S</td>
<td id="T_076e6_row1_col2" class="data row1 col2">low</td>
<td id="T_076e6_row1_col3" class="data row1 col3">False</td>
</tr>
<tr class="odd">
<td id="T_076e6_row2_col0" class="data row2 col0">R</td>
<td id="T_076e6_row2_col1" class="data row2 col1">S</td>
<td id="T_076e6_row2_col2" class="data row2 col2">high</td>
<td id="T_076e6_row2_col3" class="data row2 col3">False</td>
</tr>
<tr class="even">
<td id="T_076e6_row3_col0" class="data row3 col0">R</td>
<td id="T_076e6_row3_col1" class="data row3 col1">M</td>
<td id="T_076e6_row3_col2" class="data row3 col2">free</td>
<td id="T_076e6_row3_col3" class="data row3 col3">False</td>
</tr>
<tr class="odd">
<td id="T_076e6_row4_col0" class="data row4 col0">R</td>
<td id="T_076e6_row4_col1" class="data row4 col1">M</td>
<td id="T_076e6_row4_col2" class="data row4 col2">low</td>
<td id="T_076e6_row4_col3" class="data row4 col3">False</td>
</tr>
<tr class="even">
<td id="T_076e6_row5_col0" class="data row5 col0">R</td>
<td id="T_076e6_row5_col1" class="data row5 col1">L</td>
<td id="T_076e6_row5_col2" class="data row5 col2">free</td>
<td id="T_076e6_row5_col3" class="data row5 col3">True</td>
</tr>
<tr class="odd">
<td id="T_076e6_row6_col0" class="data row6 col0">R</td>
<td id="T_076e6_row6_col1" class="data row6 col1">L</td>
<td id="T_076e6_row6_col2" class="data row6 col2">high</td>
<td id="T_076e6_row6_col3" class="data row6 col3">False</td>
</tr>
<tr class="even">
<td id="T_076e6_row7_col0" class="data row7 col0">R</td>
<td id="T_076e6_row7_col1" class="data row7 col1">M</td>
<td id="T_076e6_row7_col2" class="data row7 col2">free</td>
<td id="T_076e6_row7_col3" class="data row7 col3">False</td>
</tr>
<tr class="odd">
<td id="T_076e6_row8_col0" class="data row8 col0">R</td>
<td id="T_076e6_row8_col1" class="data row8 col1">S</td>
<td id="T_076e6_row8_col2" class="data row8 col2">free</td>
<td id="T_076e6_row8_col3" class="data row8 col3">False</td>
</tr>
<tr class="even">
<td id="T_076e6_row9_col0" class="data row9 col0">R</td>
<td id="T_076e6_row9_col1" class="data row9 col1">S</td>
<td id="T_076e6_row9_col2" class="data row9 col2">free</td>
<td id="T_076e6_row9_col3" class="data row9 col3">False</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>To produce the probability tables, we must first calculate the prior probabilities for each of the classes in our label column, classes.</p>
<p>From here, we can iterate on the remaining columns with respect to the label column. In our case, we have the columns of cost, size, and tested.</p>
<p>The general process is as follows:</p>
<ul>
<li><p>select the feature column</p></li>
<li><p>for each unique value within the feature column, <span class="math inline">\(X_j\)</span>:</p>
<ul>
<li><p>for each unique class in our labels:</p>
<ul>
<li><p>get the raw count of the number of records where the feature column is equal to the unique value <em>and</em> the class is equal to the current class. This is a proxy for <span class="math inline">\(P(X_i|Y)\)</span></p></li>
<li><p>calculate the total raw of each class in the resulting filter, analogous to <span class="math inline">\(P(Y)\)</span></p></li>
<li><p>use the above calulations to calculate <span class="math inline">\(P(Y_i|X)\)</span> as listed in <a href="#eq-bayes2" class="quarto-xref">Equation&nbsp;<span>7.2</span></a></p></li>
<li><p>select the highest value for <span class="math inline">\(P(Y_i|X)\)</span> to select the class prediction</p></li>
</ul></li>
</ul></li>
</ul>
<p>Using this, we can precompute relative frequencies and probabilities <span class="math inline">\(P(Y|X_i)\)</span> for each value, given that the record is a member of the target class:</p>
<div class="cell" data-execution_count="7">
<div id="tbl-size-freqs" class="cell quarto-float anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-size-freqs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.2: relative frequency of size, given class
</figcaption>
<div aria-describedby="tbl-size-freqs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="7">
<style type="text/css">
</style>

<table id="T_43195" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_43195_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">size</th>
<th id="T_43195_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">class</th>
<th id="T_43195_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">count</th>
<th id="T_43195_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_43195_row0_col0" class="data row0 col0">S</td>
<td id="T_43195_row0_col1" class="data row0 col1">B</td>
<td id="T_43195_row0_col2" class="data row0 col2">34</td>
<td id="T_43195_row0_col3" class="data row0 col3">0.272000</td>
</tr>
<tr class="even">
<td id="T_43195_row1_col0" class="data row1 col0">M</td>
<td id="T_43195_row1_col1" class="data row1 col1">B</td>
<td id="T_43195_row1_col2" class="data row1 col2">43</td>
<td id="T_43195_row1_col3" class="data row1 col3">0.344000</td>
</tr>
<tr class="odd">
<td id="T_43195_row2_col0" class="data row2 col0">L</td>
<td id="T_43195_row2_col1" class="data row2 col1">B</td>
<td id="T_43195_row2_col2" class="data row2 col2">48</td>
<td id="T_43195_row2_col3" class="data row2 col3">0.384000</td>
</tr>
<tr class="even">
<td id="T_43195_row3_col0" class="data row3 col0">S</td>
<td id="T_43195_row3_col1" class="data row3 col1">G</td>
<td id="T_43195_row3_col2" class="data row3 col2">31</td>
<td id="T_43195_row3_col3" class="data row3 col3">0.269565</td>
</tr>
<tr class="odd">
<td id="T_43195_row4_col0" class="data row4 col0">M</td>
<td id="T_43195_row4_col1" class="data row4 col1">G</td>
<td id="T_43195_row4_col2" class="data row4 col2">47</td>
<td id="T_43195_row4_col3" class="data row4 col3">0.408696</td>
</tr>
<tr class="even">
<td id="T_43195_row5_col0" class="data row5 col0">L</td>
<td id="T_43195_row5_col1" class="data row5 col1">G</td>
<td id="T_43195_row5_col2" class="data row5 col2">37</td>
<td id="T_43195_row5_col3" class="data row5 col3">0.321739</td>
</tr>
<tr class="odd">
<td id="T_43195_row6_col0" class="data row6 col0">S</td>
<td id="T_43195_row6_col1" class="data row6 col1">R</td>
<td id="T_43195_row6_col2" class="data row6 col2">25</td>
<td id="T_43195_row6_col3" class="data row6 col3">0.333333</td>
</tr>
<tr class="even">
<td id="T_43195_row7_col0" class="data row7 col0">M</td>
<td id="T_43195_row7_col1" class="data row7 col1">R</td>
<td id="T_43195_row7_col2" class="data row7 col2">27</td>
<td id="T_43195_row7_col3" class="data row7 col3">0.360000</td>
</tr>
<tr class="odd">
<td id="T_43195_row8_col0" class="data row8 col0">L</td>
<td id="T_43195_row8_col1" class="data row8 col1">R</td>
<td id="T_43195_row8_col2" class="data row8 col2">23</td>
<td id="T_43195_row8_col3" class="data row8 col3">0.306667</td>
</tr>
<tr class="even">
<td id="T_43195_row9_col0" class="data row9 col0">S</td>
<td id="T_43195_row9_col1" class="data row9 col1">Y</td>
<td id="T_43195_row9_col2" class="data row9 col2">36</td>
<td id="T_43195_row9_col3" class="data row9 col3">0.423529</td>
</tr>
<tr class="odd">
<td id="T_43195_row10_col0" class="data row10 col0">M</td>
<td id="T_43195_row10_col1" class="data row10 col1">Y</td>
<td id="T_43195_row10_col2" class="data row10 col2">23</td>
<td id="T_43195_row10_col3" class="data row10 col3">0.270588</td>
</tr>
<tr class="even">
<td id="T_43195_row11_col0" class="data row11 col0">L</td>
<td id="T_43195_row11_col1" class="data row11 col1">Y</td>
<td id="T_43195_row11_col2" class="data row11 col2">26</td>
<td id="T_43195_row11_col3" class="data row11 col3">0.305882</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="8">
<div id="tbl-cost-freqs" class="cell quarto-float anchored" data-execution_count="8">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cost-freqs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.3: relative frequency of cost, given class
</figcaption>
<div aria-describedby="tbl-cost-freqs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="8">
<style type="text/css">
</style>

<table id="T_61609" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_61609_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">cost</th>
<th id="T_61609_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">class</th>
<th id="T_61609_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">count</th>
<th id="T_61609_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_61609_row0_col0" class="data row0 col0">low</td>
<td id="T_61609_row0_col1" class="data row0 col1">B</td>
<td id="T_61609_row0_col2" class="data row0 col2">24</td>
<td id="T_61609_row0_col3" class="data row0 col3">0.192000</td>
</tr>
<tr class="even">
<td id="T_61609_row1_col0" class="data row1 col0">high</td>
<td id="T_61609_row1_col1" class="data row1 col1">B</td>
<td id="T_61609_row1_col2" class="data row1 col2">26</td>
<td id="T_61609_row1_col3" class="data row1 col3">0.208000</td>
</tr>
<tr class="odd">
<td id="T_61609_row2_col0" class="data row2 col0">free</td>
<td id="T_61609_row2_col1" class="data row2 col1">B</td>
<td id="T_61609_row2_col2" class="data row2 col2">38</td>
<td id="T_61609_row2_col3" class="data row2 col3">0.304000</td>
</tr>
<tr class="even">
<td id="T_61609_row3_col0" class="data row3 col0">medium</td>
<td id="T_61609_row3_col1" class="data row3 col1">B</td>
<td id="T_61609_row3_col2" class="data row3 col2">37</td>
<td id="T_61609_row3_col3" class="data row3 col3">0.296000</td>
</tr>
<tr class="odd">
<td id="T_61609_row4_col0" class="data row4 col0">low</td>
<td id="T_61609_row4_col1" class="data row4 col1">G</td>
<td id="T_61609_row4_col2" class="data row4 col2">33</td>
<td id="T_61609_row4_col3" class="data row4 col3">0.286957</td>
</tr>
<tr class="even">
<td id="T_61609_row5_col0" class="data row5 col0">high</td>
<td id="T_61609_row5_col1" class="data row5 col1">G</td>
<td id="T_61609_row5_col2" class="data row5 col2">22</td>
<td id="T_61609_row5_col3" class="data row5 col3">0.191304</td>
</tr>
<tr class="odd">
<td id="T_61609_row6_col0" class="data row6 col0">free</td>
<td id="T_61609_row6_col1" class="data row6 col1">G</td>
<td id="T_61609_row6_col2" class="data row6 col2">28</td>
<td id="T_61609_row6_col3" class="data row6 col3">0.243478</td>
</tr>
<tr class="even">
<td id="T_61609_row7_col0" class="data row7 col0">medium</td>
<td id="T_61609_row7_col1" class="data row7 col1">G</td>
<td id="T_61609_row7_col2" class="data row7 col2">32</td>
<td id="T_61609_row7_col3" class="data row7 col3">0.278261</td>
</tr>
<tr class="odd">
<td id="T_61609_row8_col0" class="data row8 col0">low</td>
<td id="T_61609_row8_col1" class="data row8 col1">R</td>
<td id="T_61609_row8_col2" class="data row8 col2">18</td>
<td id="T_61609_row8_col3" class="data row8 col3">0.240000</td>
</tr>
<tr class="even">
<td id="T_61609_row9_col0" class="data row9 col0">high</td>
<td id="T_61609_row9_col1" class="data row9 col1">R</td>
<td id="T_61609_row9_col2" class="data row9 col2">24</td>
<td id="T_61609_row9_col3" class="data row9 col3">0.320000</td>
</tr>
<tr class="odd">
<td id="T_61609_row10_col0" class="data row10 col0">free</td>
<td id="T_61609_row10_col1" class="data row10 col1">R</td>
<td id="T_61609_row10_col2" class="data row10 col2">19</td>
<td id="T_61609_row10_col3" class="data row10 col3">0.253333</td>
</tr>
<tr class="even">
<td id="T_61609_row11_col0" class="data row11 col0">medium</td>
<td id="T_61609_row11_col1" class="data row11 col1">R</td>
<td id="T_61609_row11_col2" class="data row11 col2">14</td>
<td id="T_61609_row11_col3" class="data row11 col3">0.186667</td>
</tr>
<tr class="odd">
<td id="T_61609_row12_col0" class="data row12 col0">low</td>
<td id="T_61609_row12_col1" class="data row12 col1">Y</td>
<td id="T_61609_row12_col2" class="data row12 col2">20</td>
<td id="T_61609_row12_col3" class="data row12 col3">0.235294</td>
</tr>
<tr class="even">
<td id="T_61609_row13_col0" class="data row13 col0">high</td>
<td id="T_61609_row13_col1" class="data row13 col1">Y</td>
<td id="T_61609_row13_col2" class="data row13 col2">19</td>
<td id="T_61609_row13_col3" class="data row13 col3">0.223529</td>
</tr>
<tr class="odd">
<td id="T_61609_row14_col0" class="data row14 col0">free</td>
<td id="T_61609_row14_col1" class="data row14 col1">Y</td>
<td id="T_61609_row14_col2" class="data row14 col2">19</td>
<td id="T_61609_row14_col3" class="data row14 col3">0.223529</td>
</tr>
<tr class="even">
<td id="T_61609_row15_col0" class="data row15 col0">medium</td>
<td id="T_61609_row15_col1" class="data row15 col1">Y</td>
<td id="T_61609_row15_col2" class="data row15 col2">27</td>
<td id="T_61609_row15_col3" class="data row15 col3">0.317647</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="9">
<div id="tbl-test-freqs" class="cell quarto-float anchored" data-execution_count="9">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-test-freqs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.4: relative frequency of tested, given class
</figcaption>
<div aria-describedby="tbl-test-freqs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="9">
<style type="text/css">
</style>

<table id="T_9e1aa" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_9e1aa_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">tested</th>
<th id="T_9e1aa_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">class</th>
<th id="T_9e1aa_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">count</th>
<th id="T_9e1aa_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_9e1aa_row0_col0" class="data row0 col0">False</td>
<td id="T_9e1aa_row0_col1" class="data row0 col1">B</td>
<td id="T_9e1aa_row0_col2" class="data row0 col2">56</td>
<td id="T_9e1aa_row0_col3" class="data row0 col3">0.448000</td>
</tr>
<tr class="even">
<td id="T_9e1aa_row1_col0" class="data row1 col0">True</td>
<td id="T_9e1aa_row1_col1" class="data row1 col1">B</td>
<td id="T_9e1aa_row1_col2" class="data row1 col2">69</td>
<td id="T_9e1aa_row1_col3" class="data row1 col3">0.552000</td>
</tr>
<tr class="odd">
<td id="T_9e1aa_row2_col0" class="data row2 col0">False</td>
<td id="T_9e1aa_row2_col1" class="data row2 col1">G</td>
<td id="T_9e1aa_row2_col2" class="data row2 col2">64</td>
<td id="T_9e1aa_row2_col3" class="data row2 col3">0.556522</td>
</tr>
<tr class="even">
<td id="T_9e1aa_row3_col0" class="data row3 col0">True</td>
<td id="T_9e1aa_row3_col1" class="data row3 col1">G</td>
<td id="T_9e1aa_row3_col2" class="data row3 col2">51</td>
<td id="T_9e1aa_row3_col3" class="data row3 col3">0.443478</td>
</tr>
<tr class="odd">
<td id="T_9e1aa_row4_col0" class="data row4 col0">False</td>
<td id="T_9e1aa_row4_col1" class="data row4 col1">R</td>
<td id="T_9e1aa_row4_col2" class="data row4 col2">43</td>
<td id="T_9e1aa_row4_col3" class="data row4 col3">0.573333</td>
</tr>
<tr class="even">
<td id="T_9e1aa_row5_col0" class="data row5 col0">True</td>
<td id="T_9e1aa_row5_col1" class="data row5 col1">R</td>
<td id="T_9e1aa_row5_col2" class="data row5 col2">32</td>
<td id="T_9e1aa_row5_col3" class="data row5 col3">0.426667</td>
</tr>
<tr class="odd">
<td id="T_9e1aa_row6_col0" class="data row6 col0">False</td>
<td id="T_9e1aa_row6_col1" class="data row6 col1">Y</td>
<td id="T_9e1aa_row6_col2" class="data row6 col2">46</td>
<td id="T_9e1aa_row6_col3" class="data row6 col3">0.541176</td>
</tr>
<tr class="even">
<td id="T_9e1aa_row7_col0" class="data row7 col0">True</td>
<td id="T_9e1aa_row7_col1" class="data row7 col1">Y</td>
<td id="T_9e1aa_row7_col2" class="data row7 col2">39</td>
<td id="T_9e1aa_row7_col3" class="data row7 col3">0.458824</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>These probability tables are pre-computed and used for future classification tasks. We directly treat these as <em>independent probabilities</em> and on introduction of a new record, we simply perform the following tasks:</p>
<ul>
<li><p>For every possible result classification, <span class="math inline">\(y_i\)</span> (in our case, G, B, Y, and R):</p>
<ul>
<li><p>Take the new input record</p></li>
<li><p>Start with prob = prior probability for each class (the relative frequency of each class <span class="math inline">\(y_i\)</span> in the source data)</p></li>
<li><p>Iterate through the pre-computed probability tables for size, cost, and tested:</p>
<ul>
<li><p>get the value of the probability column where the class is the current possible result classification <span class="math inline">\(y_i\)</span> <em>and</em> the record feature value is equal to the table feature value.</p></li>
<li><p>multiply the current value for prob by the selected value. This is analogous to <a href="#eq-naive3" class="quarto-xref">Equation&nbsp;<span>7.8</span></a> for the current class <span class="math inline">\(y_i\)</span></p></li>
</ul></li>
<li><p>after completion we have <span class="math inline">\(P(Y=y_i|X)\)</span></p></li>
</ul></li>
<li><p>now that we’ve collected all <span class="math inline">\(P(Y|X)\)</span> for every <span class="math inline">\(y_i\)</span>, one selects the maximum value amongst all <span class="math inline">\(P(Y=y_i|X)\)</span> and set the predicted class as <span class="math inline">\(y_i\)</span></p></li>
</ul>
<p>Examining this process for the below example record:</p>
<div class="cell" data-execution_count="10">
<div id="tbl-record-examp" class="cell quarto-float anchored" data-execution_count="10">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-record-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.5: New Record for Testing the Model
</figcaption>
<div aria-describedby="tbl-record-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="10">
<style type="text/css">
</style>

<table id="T_5ae3b" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_5ae3b_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">size</th>
<th id="T_5ae3b_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">cost</th>
<th id="T_5ae3b_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">tested</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_5ae3b_row0_col0" class="data row0 col0">L</td>
<td id="T_5ae3b_row0_col1" class="data row0 col1">medium</td>
<td id="T_5ae3b_row0_col2" class="data row0 col2">True</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>To perform the calculation, one can initialize the data with the prior probability <span class="math inline">\(P(Y)\)</span> for each potential output class.</p>
<div class="cell" data-execution_count="11">
<div id="tbl-init-alg-examp" class="cell quarto-float anchored" data-execution_count="11">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-init-alg-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.6: Prior probabilites (P(Y))
</figcaption>
<div aria-describedby="tbl-init-alg-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="11">
<style type="text/css">
</style>

<table id="T_824b9" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_824b9_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">B</th>
<th id="T_824b9_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">G</th>
<th id="T_824b9_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Y</th>
<th id="T_824b9_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_824b9_row0_col0" class="data row0 col0">0.312500</td>
<td id="T_824b9_row0_col1" class="data row0 col1">0.287500</td>
<td id="T_824b9_row0_col2" class="data row0 col2">0.212500</td>
<td id="T_824b9_row0_col3" class="data row0 col3">0.187500</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>From here, one must examine the values in each table, where the column in <a href="#tbl-record-examp" class="quarto-xref">Table&nbsp;<span>7.5</span></a> column is equal to the same column in each of our pre-computed tables, <a href="#tbl-size-freqs" class="quarto-xref">Table&nbsp;<span>7.2</span></a>,</p>
<div class="cell" data-execution_count="12">
<div id="tbl-size-examp" class="cell quarto-float anchored" data-execution_count="12">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-size-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.7: Probabilites from Size Frequencies where size=L
</figcaption>
<div aria-describedby="tbl-size-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="12">
<style type="text/css">
</style>

<table id="T_b40cd" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_b40cd_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">B</th>
<th id="T_b40cd_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">G</th>
<th id="T_b40cd_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Y</th>
<th id="T_b40cd_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b40cd_row0_col0" class="data row0 col0">0.384000</td>
<td id="T_b40cd_row0_col1" class="data row0 col1">0.321739</td>
<td id="T_b40cd_row0_col2" class="data row0 col2">0.305882</td>
<td id="T_b40cd_row0_col3" class="data row0 col3">0.306667</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>for <a href="#tbl-cost-freqs" class="quarto-xref">Table&nbsp;<span>7.3</span></a>,</p>
<div class="cell" data-execution_count="13">
<div id="tbl-cost-examp" class="cell quarto-float anchored" data-execution_count="13">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cost-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.8: Probabilites from Size Frequencies where cost=medium
</figcaption>
<div aria-describedby="tbl-cost-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="13">
<style type="text/css">
</style>

<table id="T_f64bf" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_f64bf_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">B</th>
<th id="T_f64bf_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">G</th>
<th id="T_f64bf_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Y</th>
<th id="T_f64bf_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_f64bf_row0_col0" class="data row0 col0">0.296000</td>
<td id="T_f64bf_row0_col1" class="data row0 col1">0.278261</td>
<td id="T_f64bf_row0_col2" class="data row0 col2">0.317647</td>
<td id="T_f64bf_row0_col3" class="data row0 col3">0.186667</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>and for <a href="#tbl-test-freqs" class="quarto-xref">Table&nbsp;<span>7.4</span></a></p>
<div class="cell" data-execution_count="14">
<div id="tbl-tested-examp" class="cell quarto-float anchored" data-execution_count="14">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tested-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.9: Probabilites from Tested Frequencies where tested=True
</figcaption>
<div aria-describedby="tbl-tested-examp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="14">
<style type="text/css">
</style>

<table id="T_ad275" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_ad275_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">B</th>
<th id="T_ad275_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">G</th>
<th id="T_ad275_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Y</th>
<th id="T_ad275_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_ad275_row0_col0" class="data row0 col0">0.552000</td>
<td id="T_ad275_row0_col1" class="data row0 col1">0.443478</td>
<td id="T_ad275_row0_col2" class="data row0 col2">0.458824</td>
<td id="T_ad275_row0_col3" class="data row0 col3">0.426667</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Taking each of these (the prior probabilities and the extracted probabilities), one can calculate the probability <span class="math inline">\(P(Y_i|X))\)</span> for the input record</p>
<div class="cell" data-execution_count="15">
<div id="tbl-product" class="cell quarto-float anchored" data-execution_count="15">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-product-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.10: Calculation of P(Y|X)
</figcaption>
<div aria-describedby="tbl-product-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">class</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">G</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">prob</td>
<td>0.019607</td>
<td>0.011415</td>
<td>0.009473</td>
<td>0.00458</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>The final result, one can see, is that the classification of the record will be “B”, as it has the highest probability amongst all the potential classes.</p>
</section>
<section id="the-zero-frequency-problem" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="the-zero-frequency-problem"><span class="header-section-number">7.1.3</span> The Zero-Frequency Problem</h3>
<p>One challenge with the Naive Bayes algorithm is when one or more of the feature spaces has zero occurences within a given output class. When this occurs, it sets the probability for a record being a member of that class to zero, meaning that no newly introduced data or records can <strong>ever</strong> be classified as a member of that class by the algorithm. Without additional data and training, the model will never adapt to these new inputs, because the calculation is a running product of the relative frequencies. Thus, a single relative frequency of zero will result in an overall probability of zero, and the output class will not be predicted.</p>
<!-- Simple example:  in @tbl-size-freqs, the proportion value for class=Y and size=L is replaced with zero, because in the training dataset the relative frequency of class Y having size L never occurs.   -->
<p>What if no records of class Y in the source data were ever tested?</p>
<div id="a1d9ed17" class="cell" data-execution_count="17">
<div class="cell-output cell-output-display" data-execution_count="17">
<style type="text/css">
</style>

<table id="T_dec6f" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_dec6f_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">tested</th>
<th id="T_dec6f_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">class</th>
<th id="T_dec6f_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">count</th>
<th id="T_dec6f_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_dec6f_row0_col0" class="data row0 col0">False</td>
<td id="T_dec6f_row0_col1" class="data row0 col1">B</td>
<td id="T_dec6f_row0_col2" class="data row0 col2">56</td>
<td id="T_dec6f_row0_col3" class="data row0 col3">0.448000</td>
</tr>
<tr class="even">
<td id="T_dec6f_row1_col0" class="data row1 col0">True</td>
<td id="T_dec6f_row1_col1" class="data row1 col1">B</td>
<td id="T_dec6f_row1_col2" class="data row1 col2">69</td>
<td id="T_dec6f_row1_col3" class="data row1 col3">0.552000</td>
</tr>
<tr class="odd">
<td id="T_dec6f_row2_col0" class="data row2 col0">False</td>
<td id="T_dec6f_row2_col1" class="data row2 col1">G</td>
<td id="T_dec6f_row2_col2" class="data row2 col2">64</td>
<td id="T_dec6f_row2_col3" class="data row2 col3">0.556522</td>
</tr>
<tr class="even">
<td id="T_dec6f_row3_col0" class="data row3 col0">True</td>
<td id="T_dec6f_row3_col1" class="data row3 col1">G</td>
<td id="T_dec6f_row3_col2" class="data row3 col2">51</td>
<td id="T_dec6f_row3_col3" class="data row3 col3">0.443478</td>
</tr>
<tr class="odd">
<td id="T_dec6f_row4_col0" class="data row4 col0">False</td>
<td id="T_dec6f_row4_col1" class="data row4 col1">R</td>
<td id="T_dec6f_row4_col2" class="data row4 col2">43</td>
<td id="T_dec6f_row4_col3" class="data row4 col3">0.573333</td>
</tr>
<tr class="even">
<td id="T_dec6f_row5_col0" class="data row5 col0">True</td>
<td id="T_dec6f_row5_col1" class="data row5 col1">R</td>
<td id="T_dec6f_row5_col2" class="data row5 col2">32</td>
<td id="T_dec6f_row5_col3" class="data row5 col3">0.426667</td>
</tr>
<tr class="odd">
<td id="T_dec6f_row6_col0" class="data row6 col0">False</td>
<td id="T_dec6f_row6_col1" class="data row6 col1">Y</td>
<td id="T_dec6f_row6_col2" class="data row6 col2">85</td>
<td id="T_dec6f_row6_col3" class="data row6 col3">1.000000</td>
</tr>
<tr class="even">
<td id="T_dec6f_row7_col0" class="data row7 col0">True</td>
<td id="T_dec6f_row7_col1" class="data row7 col1">Y</td>
<td id="T_dec6f_row7_col2" class="data row7 col2">0</td>
<td id="T_dec6f_row7_col3" class="data row7 col3">0.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>One can see that the change of all records where class=Y and tested=True have a probability of zero.</p>
<p>This has a substatial impact on predictions, namely - whenever a record has tested=True, the trained model will produce a zero probability result for the class of a new record belonging to Y, and thus no new records will ever be classified as Y. Here’s the predicted outcome for the record in the previous example:</p>
<div id="48f3ed41" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display" data-execution_count="19">
<style type="text/css">
</style>

<table id="T_e2662" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_e2662_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">size</th>
<th id="T_e2662_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">cost</th>
<th id="T_e2662_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">tested</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_e2662_row0_col0" class="data row0 col0">L</td>
<td id="T_e2662_row0_col1" class="data row0 col1">medium</td>
<td id="T_e2662_row0_col2" class="data row0 col2">True</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We see the record has tested = True, so the outcome will never be class Y:</p>
<div id="86a0dc43" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display" data-execution_count="20">
<style type="text/css">
</style>

<table id="T_5605d" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_5605d_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">R</th>
<th id="T_5605d_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">G</th>
<th id="T_5605d_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Y</th>
<th id="T_5605d_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_5605d_row0_col0" class="data row0 col0">0.004580</td>
<td id="T_5605d_row0_col1" class="data row0 col1">0.011415</td>
<td id="T_5605d_row0_col2" class="data row0 col2">0.000000</td>
<td id="T_5605d_row0_col3" class="data row0 col3">0.019607</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The absence of a probability is, well, problematic. If the new record truly did belong to class Y, the model can never predict it as belonging to the class, due to the absence of data. There are methods and means of handling this issue, however.</p>
<p>One option includes updating an existing Naive Bayes model in relatively short order with new records, new training set information, and recomputing the prior probabilities for classification of future records. Without such additional data and retraining/updating, however, the classification challenge will remain.</p>
<p>Another option to rectify the zero-frequency issue is via smoothing methods. These methods allow for any possibility to occur, and assign minute, non-zero probabilities to any cases which have zero frequency within the training dataset. In doing this it ensures that, for every value of every considered feature, there is some probability <span class="math inline">\(p\)</span> strictly greater than zero assigned, thus allowing potential predictions into the appropriate class for any new input tuple.</p>
<p>A common smoothing technique for Multinomial Naive Bayes is Laplace smoothing. The technique adapts the calculation of the probabilites for each feature <span class="math inline">\(P(X_i|Y)\)</span> in the following manner:</p>
<p><span id="eq-laplace-smooth"><span class="math display">\[
P(X|Y) = \frac{P(Y|X) + \alpha}{P(Y)+\alpha n}
\tag{7.10}\]</span></span></p>
<p>Where <span class="math inline">\(\alpha\)</span> is equal to 1, and n is the number of total categories <span class="math inline">\(Y\)</span> in the dataset. There are The additive non-zero values to the numerator <span class="math inline">\(\alpha\)</span> and the denominator <span class="math inline">\(\alpha n\)</span> ensures that the probabilities for all <span class="math inline">\(P(X_i|Y)\)</span> are greater than zero, thus enabling them to (potentially) be predicted by the model. It’s possible that a single, and potentially less important, feature could be the difference between whether or not the correct class can be predicted absent such smoothing, but the inclusion of Laplace or other smoothing techniques can support better modeling.</p>
<p>Thus far, everything explained above examines <em>Categorical</em> naive bayes. There are several other versions of the Naive Bayes algorithm that operate under the same independence assumption, but algorithmic performance differs from what has been explained thus far.</p>
</section>
<section id="bernoulli-naive-bayes" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="bernoulli-naive-bayes"><span class="header-section-number">7.1.4</span> Bernoulli Naive Bayes</h3>
<p>This algorithm performs similarly to the Multinomial Naive Bayes algorithm, but on binary encoded (0/1) data. Every category in each feature needs to be transferred into a column, and then each column is set to a zero if a record does not have the specified category value for that feature, and a one otherwise.</p>
<p>However, the probabilities are calculated differently from that of the Multinomial Naive Bayes Algorithm. For calculating the values of the prior probabilities in the training data, the formula is repaced as follows:</p>
<p><span class="math display">\[
P(x_i|y) = P(x_i=1|y)\cdot x_i + (1-P(x_i=1|y))\cdot(1-x_i)
\]</span></p>
<p>This is similar to the construct of the binomial distribution (chance for k successes in n trials), and is repeated for each feature value <span class="math inline">\(x_i\)</span> in the dataset. This is of benefit to Bernoulli naive bayes over Multinomial, as it will include and penalize non-occuring combinations of <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y\)</span> together in the dataset.</p>
<p>Some advantages of Bernoulli naive bayes are that it is relatively simple (for small datasets) to implement and that it performs well on tasks such as task classification (e.g.&nbsp;detecting spam emails, for instance). However, it is only able to categorize or predict on a binary outcome, similar to logistic regression. This is applicable for this research, but may not fit all use cases.</p>
</section>
</section>
<section id="data-and-code" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="data-and-code"><span class="header-section-number">7.2</span> Data and Code</h2>
<ul>
<li><p><a href="https://drive.google.com/file/d/1Br4X_FhYl673QKQo5PlDkyEs6FjjvFzn/view?usp=drive_link">MultinomialNB (With Protected Classes)</a></p></li>
<li><p><a href="https://drive.google.com/file/d/1TefbM2T1AcnLxcyHkgSelqNEoDDGKBrn/view?usp=drive_link">MultinomialNB (Without Protected Classes)</a></p></li>
<li><p><a href="https://drive.google.com/file/d/1Nj2P23ZMlQCzdnMdvJVKH_dufNl_tmrr/view?usp=drive_link">CategoricalNB (With Protected Classes)</a></p></li>
<li><p><a href="https://drive.google.com/file/d/1ybGEqiSdRsqu0j9O1KJXZgyJrSlX7JNl/view?usp=drive_link">CategoricalNB (Without Protected Classes)</a></p></li>
<li><p><a href="https://drive.google.com/file/d/1Br4X_FhYl673QKQo5PlDkyEs6FjjvFzn/view?usp=drive_link">BernoulliNB (With Protected Classes)</a></p></li>
<li><p><a href="https://drive.google.com/file/d/1TefbM2T1AcnLxcyHkgSelqNEoDDGKBrn/view?usp=drive_link">BernoulliNB (Without Protected Classes)</a></p></li>
</ul>
<p>To prepare the data, several steps were necessary. Namely, the data for this research effort is of mixed (categorical and quantitative) types. Different data transformation techniques and algorithms were required for application to source data to place it in a usable format for each Naive Bayes algorithm.</p>
<p>For all model code, in addition to building 2 models with and without protected class information, an exploration into statistically significant differences in model performance was performed. The experiment is constructed under the following parameters:</p>
<ul>
<li><p>For each naive bayes model type, repeat the following steps, 500 times:</p>
<ul>
<li><p>initialize a random seed</p></li>
<li><p>sample the records from both datasets (with and without protected class information) using the same random seed so as to pull the same records, on an 80/20 train/test split. This ensures the same subjects are present in the training and testing data for each random sampling.</p></li>
<li><p>train two models using the training data</p>
<ul>
<li>in the event of an error in fitting or predicting under the current train/test split, decrement the loop counter so that we ensure 500 measurements and restart the loop.</li>
</ul></li>
<li><p>predict the outcomes using the testing data</p></li>
<li><p>capture model performance metrics (accuracy, precision, recall, F1, ROC-AUC) for the two models trained with and without protected class information (age/gender/race).</p></li>
</ul></li>
<li><p>After metrics for 500 models are captured:</p>
<ul>
<li><p>Construct a paired-t test for difference in means between the two models’ performance metrics, on a per-metric basis.</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: There is no difference in the mean performance metric for models when trained with and without protected class information</p></li>
<li><p><span class="math inline">\(H_A\)</span>: One of the models has a higher mean performance metric when protected class information is included</p></li>
<li><p><span class="math inline">\(\alpha=0.003\)</span> or a <span class="math inline">\(3\sigma\)</span> confidence</p></li>
</ul></li>
<li><p>Visualize the distribution of performance metrics for each model</p></li>
<li><p>Conclude on any statistically significant differences between the models’ performance</p></li>
</ul></li>
</ul>
<p>The output for these tests are located as follows:</p>
<ul>
<li><p><a href="https://drive.google.com/file/d/1wWfVUvsEVQSAlQrKQnu-PplhcUnmJ9Ar/view?usp=drive_link">MultinomialNB Randomization Testing</a></p></li>
<li><p><a href="https://drive.google.com/file/d/1x5LhOlydQIymZCYtn3RgcVtdZkKeojHr/view?usp=drive_link">CategoricalNB Randomization Testing</a></p></li>
<li><p><a href="https://drive.google.com/file/d/1iF4UCojUO7N9a7wcj3oWZteg5gY-mjhX/view?usp=drive_link">BernoulliNB Randomization Testing</a></p></li>
</ul>
<section id="multinomial-naive-bayes" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="multinomial-naive-bayes"><span class="header-section-number">7.2.1</span> Multinomial Naive Bayes</h3>
<p>The data prepration and code were executed natively in <a href="app8-mca.html" class="quarto-xref"><span>Appendix G</span></a>, sourcing from the final clean dataset.</p>
<p>Multinomial Naive Bayes requires count data. Since the native format of the initially cleaned dataset is purely record data, there are challenges to convert this to count information. Namely, each feature and feature value either occurs, or it doesn’t. As such, the data had to be transformed into a one-hot encoded dataset with either 1 if the feature value occurred in the record, and 0 otherwise. This same data is leveraged in Bernoulli Naive Bayes for this portion of the research.</p>
<div class="cell" data-execution_count="22">
<div id="tbl-init-data" class="cell quarto-float anchored" data-execution_count="22">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-init-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.11: Initial Data Used
</figcaption>
<div aria-describedby="tbl-init-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state_code</th>
<th data-quarto-table-cell-role="th">county_code</th>
<th data-quarto-table-cell-role="th">derived_sex</th>
<th data-quarto-table-cell-role="th">action_taken</th>
<th data-quarto-table-cell-role="th">purchaser_type</th>
<th data-quarto-table-cell-role="th">preapproval</th>
<th data-quarto-table-cell-role="th">open-end_line_of_credit</th>
<th data-quarto-table-cell-role="th">loan_amount</th>
<th data-quarto-table-cell-role="th">loan_to_value_ratio</th>
<th data-quarto-table-cell-role="th">interest_rate</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units</th>
<th data-quarto-table-cell-role="th">applicant_race</th>
<th data-quarto-table-cell-role="th">co-applicant_race</th>
<th data-quarto-table-cell-role="th">applicant_ethnicity</th>
<th data-quarto-table-cell-role="th">co-applicant_ethnicity</th>
<th data-quarto-table-cell-role="th">aus</th>
<th data-quarto-table-cell-role="th">denial_reason</th>
<th data-quarto-table-cell-role="th">outcome</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">income_from_median</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>OH</td>
<td>39153.0</td>
<td>Sex Not Available</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>665000.0</td>
<td>85.000</td>
<td>4.250</td>
<td>...</td>
<td>36</td>
<td>32768</td>
<td>131072</td>
<td>32</td>
<td>128</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>36061.0</td>
<td>Male</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>755000.0</td>
<td>21.429</td>
<td>4.250</td>
<td>...</td>
<td>0</td>
<td>32768</td>
<td>262144</td>
<td>64</td>
<td>256</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NY</td>
<td>36061.0</td>
<td>Sex Not Available</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>965000.0</td>
<td>80.000</td>
<td>5.250</td>
<td>...</td>
<td>0</td>
<td>65536</td>
<td>262144</td>
<td>64</td>
<td>256</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>FL</td>
<td>12011.0</td>
<td>Male</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>705000.0</td>
<td>92.175</td>
<td>5.125</td>
<td>...</td>
<td>12</td>
<td>32768</td>
<td>262144</td>
<td>32</td>
<td>256</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MD</td>
<td>24031.0</td>
<td>Joint</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>1005000.0</td>
<td>65.574</td>
<td>5.625</td>
<td>...</td>
<td>69</td>
<td>66</td>
<td>32768</td>
<td>32</td>
<td>32</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NC</td>
<td>37089.0</td>
<td>Joint</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>695000.0</td>
<td>85.000</td>
<td>6.000</td>
<td>...</td>
<td>39</td>
<td>32768</td>
<td>32768</td>
<td>32</td>
<td>32</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>CA</td>
<td>6073.0</td>
<td>Joint</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>905000.0</td>
<td>75.000</td>
<td>6.250</td>
<td>...</td>
<td>44</td>
<td>2</td>
<td>2</td>
<td>32</td>
<td>32</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NY</td>
<td>36061.0</td>
<td>Sex Not Available</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>355000.0</td>
<td>15.909</td>
<td>5.625</td>
<td>...</td>
<td>63</td>
<td>65536</td>
<td>65536</td>
<td>64</td>
<td>64</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NY</td>
<td>36061.0</td>
<td>Joint</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1085000.0</td>
<td>90.000</td>
<td>5.625</td>
<td>...</td>
<td>75</td>
<td>32768</td>
<td>32768</td>
<td>32</td>
<td>32</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>MO</td>
<td>29189.0</td>
<td>Sex Not Available</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>405000.0</td>
<td>53.333</td>
<td>5.750</td>
<td>...</td>
<td>0</td>
<td>65536</td>
<td>65536</td>
<td>64</td>
<td>64</td>
<td>64</td>
<td>512</td>
<td>1.0</td>
<td>JP Morgan</td>
<td>True</td>
</tr>
</tbody>
</table>

<p>10 rows × 51 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="24">
<div id="tbl-mnb-pc-trn-data" class="cell quarto-float anchored" data-execution_count="24">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mnb-pc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.12: MultinomialNB Training Data (With protected classes)
</figcaption>
<div aria-describedby="tbl-mnb-pc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">derived_sex_Female</th>
<th data-quarto-table-cell-role="th">derived_sex_Joint</th>
<th data-quarto-table-cell-role="th">derived_sex_Male</th>
<th data-quarto-table-cell-role="th">derived_sex_Sex Not Available</th>
<th data-quarto-table-cell-role="th">purchaser_type_0</th>
<th data-quarto-table-cell-role="th">purchaser_type_1</th>
<th data-quarto-table-cell-role="th">purchaser_type_3</th>
<th data-quarto-table-cell-role="th">purchaser_type_5</th>
<th data-quarto-table-cell-role="th">purchaser_type_6</th>
<th data-quarto-table-cell-role="th">purchaser_type_9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">co-applicant_ethnicity_No Co-applicant</th>
<th data-quarto-table-cell-role="th">aus_Desktop Underwriter</th>
<th data-quarto-table-cell-role="th">aus_Loan Prospector/Product Advisor</th>
<th data-quarto-table-cell-role="th">aus_TOTAL Scorecard</th>
<th data-quarto-table-cell-role="th">aus_GUS</th>
<th data-quarto-table-cell-role="th">aus_Other</th>
<th data-quarto-table-cell-role="th">aus_Internal Proprietary</th>
<th data-quarto-table-cell-role="th">aus_Not applicable</th>
<th data-quarto-table-cell-role="th">aus_Exempt</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">149746</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105015</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29094</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">101082</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77750</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">197336</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">137650</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136772</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41734</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10710</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 244 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="25">
<div id="tbl-mnb-pc-tst-data" class="cell quarto-float anchored" data-execution_count="25">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mnb-pc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.13: MultinomialNB Testing Data (With protected classes)
</figcaption>
<div aria-describedby="tbl-mnb-pc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">derived_sex_Female</th>
<th data-quarto-table-cell-role="th">derived_sex_Joint</th>
<th data-quarto-table-cell-role="th">derived_sex_Male</th>
<th data-quarto-table-cell-role="th">derived_sex_Sex Not Available</th>
<th data-quarto-table-cell-role="th">purchaser_type_0</th>
<th data-quarto-table-cell-role="th">purchaser_type_1</th>
<th data-quarto-table-cell-role="th">purchaser_type_3</th>
<th data-quarto-table-cell-role="th">purchaser_type_5</th>
<th data-quarto-table-cell-role="th">purchaser_type_6</th>
<th data-quarto-table-cell-role="th">purchaser_type_9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">co-applicant_ethnicity_No Co-applicant</th>
<th data-quarto-table-cell-role="th">aus_Desktop Underwriter</th>
<th data-quarto-table-cell-role="th">aus_Loan Prospector/Product Advisor</th>
<th data-quarto-table-cell-role="th">aus_TOTAL Scorecard</th>
<th data-quarto-table-cell-role="th">aus_GUS</th>
<th data-quarto-table-cell-role="th">aus_Other</th>
<th data-quarto-table-cell-role="th">aus_Internal Proprietary</th>
<th data-quarto-table-cell-role="th">aus_Not applicable</th>
<th data-quarto-table-cell-role="th">aus_Exempt</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30860</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">126890</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28730</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31244</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56105</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5443</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95702</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83812</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84338</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">124545</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 244 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="26">
<div id="tbl-mnb-npc-trn-data" class="cell quarto-float anchored" data-execution_count="26">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mnb-npc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.14: MultinomialNB Training Data (No protected classes)
</figcaption>
<div aria-describedby="tbl-mnb-npc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">purchaser_type_0</th>
<th data-quarto-table-cell-role="th">purchaser_type_1</th>
<th data-quarto-table-cell-role="th">purchaser_type_3</th>
<th data-quarto-table-cell-role="th">purchaser_type_5</th>
<th data-quarto-table-cell-role="th">purchaser_type_6</th>
<th data-quarto-table-cell-role="th">purchaser_type_9</th>
<th data-quarto-table-cell-role="th">purchaser_type_71</th>
<th data-quarto-table-cell-role="th">preapproval_1</th>
<th data-quarto-table-cell-role="th">preapproval_2</th>
<th data-quarto-table-cell-role="th">open-end_line_of_credit_1</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_H</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_M</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_MH</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_ML</th>
<th data-quarto-table-cell-role="th">company_Bank of America</th>
<th data-quarto-table-cell-role="th">company_JP Morgan</th>
<th data-quarto-table-cell-role="th">company_Navy Federal Credit Union</th>
<th data-quarto-table-cell-role="th">company_Rocket Mortgage</th>
<th data-quarto-table-cell-role="th">company_Wells Fargo</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">149746</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105015</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29094</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">101082</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77750</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">197336</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">137650</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136772</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41734</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10710</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 176 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="27">
<div id="tbl-mnb-npc-tst-data" class="cell quarto-float anchored" data-execution_count="27">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mnb-npc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.15: MultinomialNB Training Data (No protected classes)
</figcaption>
<div aria-describedby="tbl-mnb-npc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">purchaser_type_0</th>
<th data-quarto-table-cell-role="th">purchaser_type_1</th>
<th data-quarto-table-cell-role="th">purchaser_type_3</th>
<th data-quarto-table-cell-role="th">purchaser_type_5</th>
<th data-quarto-table-cell-role="th">purchaser_type_6</th>
<th data-quarto-table-cell-role="th">purchaser_type_9</th>
<th data-quarto-table-cell-role="th">purchaser_type_71</th>
<th data-quarto-table-cell-role="th">preapproval_1</th>
<th data-quarto-table-cell-role="th">preapproval_2</th>
<th data-quarto-table-cell-role="th">open-end_line_of_credit_1</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_H</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_M</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_MH</th>
<th data-quarto-table-cell-role="th">tract_median_age_of_housing_units_ML</th>
<th data-quarto-table-cell-role="th">company_Bank of America</th>
<th data-quarto-table-cell-role="th">company_JP Morgan</th>
<th data-quarto-table-cell-role="th">company_Navy Federal Credit Union</th>
<th data-quarto-table-cell-role="th">company_Rocket Mortgage</th>
<th data-quarto-table-cell-role="th">company_Wells Fargo</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30860</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">126890</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28730</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31244</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56105</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5443</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95702</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83812</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84338</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">124545</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 176 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Also of note: the record indexes in <a href="reg.html#tbl-mnb-pc-trn-data" class="quarto-xref">Table&nbsp;<span>9.6</span></a> and <a href="reg.html#tbl-mnb-npc-trn-data" class="quarto-xref">Table&nbsp;<span>9.8</span></a> match one another, meaning that the two models are trained on the same subjects. Similarly, the indexes between <a href="reg.html#tbl-mnb-pc-tst-data" class="quarto-xref">Table&nbsp;<span>9.7</span></a> and <a href="reg.html#tbl-mnb-npc-tst-data" class="quarto-xref">Table&nbsp;<span>9.9</span></a> match, so they are tested on the same subjects between the two models.</p>
<p>Also note that the indexes between <a href="reg.html#tbl-mnb-pc-trn-data" class="quarto-xref">Table&nbsp;<span>9.6</span></a> and <a href="reg.html#tbl-mnb-pc-tst-data" class="quarto-xref">Table&nbsp;<span>9.7</span></a> are disjoint - that means that the model has disjoint training and testing data. Similarly, <a href="reg.html#tbl-mnb-npc-trn-data" class="quarto-xref">Table&nbsp;<span>9.8</span></a> and <a href="reg.html#tbl-mnb-npc-tst-data" class="quarto-xref">Table&nbsp;<span>9.9</span></a> are disjoint.</p>
<p>By achieving these splits, the two models evaluated with and without protected class information will avoid unnecessary biases in the results. When a model is tested on data with which it has already been trained, the model has already optimized to the best of its ability to correctly classify the training data. As such, the outcome of an evaluation of a model using the same data in training and testing will artificially inflate its performance metrics (accuracy, precision, recall, F1, ROC-AUC). As such, it is paramount to have a disjoint training and testing dataset.</p>
</section>
<section id="bernoulli-naive-bayes-1" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="bernoulli-naive-bayes-1"><span class="header-section-number">7.2.2</span> Bernoulli Naive Bayes</h3>
<p>The data preparation was executed in <a href="app8-mca.html" class="quarto-xref"><span>Appendix G</span></a>, sourced from the final clean dataset. To prepare the data for two different models, 2 copies were made. The second copy dropped all columns that included protected class information, and the first retained all source columns.</p>
<p>To perform an MCA, the data must be in a one-hot-encoded (or binary 0/1) format per category and feature. Since this work was previously done, the steps were seamless to include for this purpose.</p>
<p>Examples of the two dataset samples used for Bernoulli Naive Bayes are summarized in <a href="reg.html#tbl-mnb-pc-trn-data" class="quarto-xref">Table&nbsp;<span>9.6</span></a>, <a href="reg.html#tbl-mnb-pc-tst-data" class="quarto-xref">Table&nbsp;<span>9.7</span></a>, <a href="reg.html#tbl-mnb-npc-trn-data" class="quarto-xref">Table&nbsp;<span>9.8</span></a>, and <a href="reg.html#tbl-mnb-npc-tst-data" class="quarto-xref">Table&nbsp;<span>9.9</span></a>.</p>
</section>
<section id="categorical-naive-bayes" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="categorical-naive-bayes"><span class="header-section-number">7.2.3</span> Categorical Naive Bayes</h3>
<p>The data for categorical naive bayes was sourced from the final clean dataset.</p>
<p>In <a href="app6.html" class="quarto-xref"><span>Appendix D</span></a>, the data is transformed into label-encoded format to perform the categorical naive bayes analysis. In some cases, binary data was captured (mostly in terms of protected class information). These binary caputred data was parsed back out into featurename:featurevalue columns with a 1 if the record met the condition, and zero otherwise. This format still meets the needs of categorical naive bayes.</p>
<div class="cell" data-execution_count="30">
<div id="tbl-cnb-pc-trn-data" class="cell quarto-float anchored" data-execution_count="30">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cnb-pc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.16: CategoricalNB Training Data (With protected classes)
</figcaption>
<div aria-describedby="tbl-cnb-pc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">derived_sex</th>
<th data-quarto-table-cell-role="th">preapproval</th>
<th data-quarto-table-cell-role="th">open-end_line_of_credit</th>
<th data-quarto-table-cell-role="th">loan_amount</th>
<th data-quarto-table-cell-role="th">loan_to_value_ratio</th>
<th data-quarto-table-cell-role="th">interest_rate</th>
<th data-quarto-table-cell-role="th">total_loan_costs</th>
<th data-quarto-table-cell-role="th">origination_charges</th>
<th data-quarto-table-cell-role="th">discount_points</th>
<th data-quarto-table-cell-role="th">lender_credits</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">co-applicant_ethnicity_No Co-applicant</th>
<th data-quarto-table-cell-role="th">aus_Desktop Underwriter</th>
<th data-quarto-table-cell-role="th">aus_Loan Prospector/Product Advisor</th>
<th data-quarto-table-cell-role="th">aus_TOTAL Scorecard</th>
<th data-quarto-table-cell-role="th">aus_GUS</th>
<th data-quarto-table-cell-role="th">aus_Other</th>
<th data-quarto-table-cell-role="th">aus_Internal Proprietary</th>
<th data-quarto-table-cell-role="th">aus_Not applicable</th>
<th data-quarto-table-cell-role="th">aus_Exempt</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">149746</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105015</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29094</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">101082</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77750</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">197336</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">137650</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136772</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41734</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10710</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 101 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="31">
<div id="tbl-cnb-pc-tst-data" class="cell quarto-float anchored" data-execution_count="31">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cnb-pc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.17: CategoricalNB Training Data (With protected classes)
</figcaption>
<div aria-describedby="tbl-cnb-pc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">derived_sex</th>
<th data-quarto-table-cell-role="th">preapproval</th>
<th data-quarto-table-cell-role="th">open-end_line_of_credit</th>
<th data-quarto-table-cell-role="th">loan_amount</th>
<th data-quarto-table-cell-role="th">loan_to_value_ratio</th>
<th data-quarto-table-cell-role="th">interest_rate</th>
<th data-quarto-table-cell-role="th">total_loan_costs</th>
<th data-quarto-table-cell-role="th">origination_charges</th>
<th data-quarto-table-cell-role="th">discount_points</th>
<th data-quarto-table-cell-role="th">lender_credits</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">co-applicant_ethnicity_No Co-applicant</th>
<th data-quarto-table-cell-role="th">aus_Desktop Underwriter</th>
<th data-quarto-table-cell-role="th">aus_Loan Prospector/Product Advisor</th>
<th data-quarto-table-cell-role="th">aus_TOTAL Scorecard</th>
<th data-quarto-table-cell-role="th">aus_GUS</th>
<th data-quarto-table-cell-role="th">aus_Other</th>
<th data-quarto-table-cell-role="th">aus_Internal Proprietary</th>
<th data-quarto-table-cell-role="th">aus_Not applicable</th>
<th data-quarto-table-cell-role="th">aus_Exempt</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30860</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">126890</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28730</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31244</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56105</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5443</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95702</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83812</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84338</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">124545</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 101 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="32">
<div id="tbl-cnb-npc-trn-data" class="cell quarto-float anchored" data-execution_count="32">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cnb-npc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.18: CategoricalNB Training Data (No protected classes)
</figcaption>
<div aria-describedby="tbl-cnb-npc-trn-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">preapproval</th>
<th data-quarto-table-cell-role="th">open-end_line_of_credit</th>
<th data-quarto-table-cell-role="th">loan_amount</th>
<th data-quarto-table-cell-role="th">loan_to_value_ratio</th>
<th data-quarto-table-cell-role="th">interest_rate</th>
<th data-quarto-table-cell-role="th">total_loan_costs</th>
<th data-quarto-table-cell-role="th">origination_charges</th>
<th data-quarto-table-cell-role="th">discount_points</th>
<th data-quarto-table-cell-role="th">lender_credits</th>
<th data-quarto-table-cell-role="th">loan_term</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">aus_Desktop Underwriter</th>
<th data-quarto-table-cell-role="th">aus_Loan Prospector/Product Advisor</th>
<th data-quarto-table-cell-role="th">aus_TOTAL Scorecard</th>
<th data-quarto-table-cell-role="th">aus_GUS</th>
<th data-quarto-table-cell-role="th">aus_Other</th>
<th data-quarto-table-cell-role="th">aus_Internal Proprietary</th>
<th data-quarto-table-cell-role="th">aus_Not applicable</th>
<th data-quarto-table-cell-role="th">aus_Exempt</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">149746</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105015</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29094</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">101082</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77750</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">197336</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">137650</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136772</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41734</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10710</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 34 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="33">
<div id="tbl-cnb-npc-tst-data" class="cell quarto-float anchored" data-execution_count="33">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cnb-npc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.19: CategoricalNB Training Data (No protected classes)
</figcaption>
<div aria-describedby="tbl-cnb-npc-tst-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">preapproval</th>
<th data-quarto-table-cell-role="th">open-end_line_of_credit</th>
<th data-quarto-table-cell-role="th">loan_amount</th>
<th data-quarto-table-cell-role="th">loan_to_value_ratio</th>
<th data-quarto-table-cell-role="th">interest_rate</th>
<th data-quarto-table-cell-role="th">total_loan_costs</th>
<th data-quarto-table-cell-role="th">origination_charges</th>
<th data-quarto-table-cell-role="th">discount_points</th>
<th data-quarto-table-cell-role="th">lender_credits</th>
<th data-quarto-table-cell-role="th">loan_term</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">aus_Desktop Underwriter</th>
<th data-quarto-table-cell-role="th">aus_Loan Prospector/Product Advisor</th>
<th data-quarto-table-cell-role="th">aus_TOTAL Scorecard</th>
<th data-quarto-table-cell-role="th">aus_GUS</th>
<th data-quarto-table-cell-role="th">aus_Other</th>
<th data-quarto-table-cell-role="th">aus_Internal Proprietary</th>
<th data-quarto-table-cell-role="th">aus_Not applicable</th>
<th data-quarto-table-cell-role="th">aus_Exempt</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">30860</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">126890</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28730</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31244</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56105</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5443</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95702</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83812</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84338</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">124545</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>10 rows × 34 columns</p>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Just as for MultinomialNB, the data for CategoricalNB has the similar combination of same indexes (between datasets) and disjoint indexes (between train test splits).</p>
</section>
</section>
<section id="results" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="results"><span class="header-section-number">7.3</span> Results</h2>
<section id="categorical-naive-bayes-1" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="categorical-naive-bayes-1"><span class="header-section-number">7.3.1</span> Categorical Naive Bayes</h3>
<div id="cell-fig-cnb-1" class="cell" data-execution_count="35">
<div class="cell-output cell-output-display">
<div id="fig-cnb-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nb_files/figure-html/fig-cnb-1-output-1.png" width="670" height="475" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Confusion Matrices (CategoricalNB, Single-Run)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="36">
<div id="tbl-cnb-1" class="cell quarto-float anchored" data-execution_count="36">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.20: Model Performance Metrics (CategoricalNB, Single Run)
</figcaption>
<div aria-describedby="tbl-cnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_2cf4f" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_2cf4f_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_2cf4f_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Data</th>
<th id="T_2cf4f_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Accuracy</th>
<th id="T_2cf4f_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Precision</th>
<th id="T_2cf4f_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Recall</th>
<th id="T_2cf4f_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">F1</th>
<th id="T_2cf4f_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">ROC-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_2cf4f_row0_col0" class="data row0 col0">CategoricalNB</td>
<td id="T_2cf4f_row0_col1" class="data row0 col1">With Protected Classes</td>
<td id="T_2cf4f_row0_col2" class="data row0 col2">0.882012</td>
<td id="T_2cf4f_row0_col3" class="data row0 col3">0.943416</td>
<td id="T_2cf4f_row0_col4" class="data row0 col4">0.917050</td>
<td id="T_2cf4f_row0_col5" class="data row0 col5">0.930046</td>
<td id="T_2cf4f_row0_col6" class="data row0 col6">0.795993</td>
</tr>
<tr class="even">
<td id="T_2cf4f_row1_col0" class="data row1 col0">CategoricalNB</td>
<td id="T_2cf4f_row1_col1" class="data row1 col1">Without Protected Classes</td>
<td id="T_2cf4f_row1_col2" class="data row1 col2">0.912455</td>
<td id="T_2cf4f_row1_col3" class="data row1 col3">0.934819</td>
<td id="T_2cf4f_row1_col4" class="data row1 col4">0.964922</td>
<td id="T_2cf4f_row1_col5" class="data row1 col5">0.949632</td>
<td id="T_2cf4f_row1_col6" class="data row1 col6">0.783651</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="cell-fig-cnb-2" class="cell" data-execution_count="37">
<div class="cell-output cell-output-display">
<div id="fig-cnb-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nb_files/figure-html/fig-cnb-2-output-1.png" width="1086" height="577" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: Metric Kernel Density Estimates (500 randomizations, CategoricalNB)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="38">
<div id="tbl-cnb-2" class="cell quarto-float anchored" data-execution_count="38">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.21: Statistical Significance Tests (Model Performance Metrics, CategoricalNB)
</figcaption>
<div aria-describedby="tbl-cnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_b7e4d" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_b7e4d_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_b7e4d_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Stat</th>
<th id="T_b7e4d_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">z-score</th>
<th id="T_b7e4d_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">p-value</th>
<th id="T_b7e4d_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">top performer</th>
<th id="T_b7e4d_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">top mean</th>
<th id="T_b7e4d_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">difference in means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b7e4d_row0_col0" class="data row0 col0">CategoricalNB</td>
<td id="T_b7e4d_row0_col1" class="data row0 col1">Accuracy</td>
<td id="T_b7e4d_row0_col2" class="data row0 col2">-8.271750</td>
<td id="T_b7e4d_row0_col3" class="data row0 col3">0.000000</td>
<td id="T_b7e4d_row0_col4" class="data row0 col4">Without Protected Classes</td>
<td id="T_b7e4d_row0_col5" class="data row0 col5">0.883466</td>
<td id="T_b7e4d_row0_col6" class="data row0 col6">0.031069</td>
</tr>
<tr class="even">
<td id="T_b7e4d_row1_col0" class="data row1 col0">CategoricalNB</td>
<td id="T_b7e4d_row1_col1" class="data row1 col1">Precision</td>
<td id="T_b7e4d_row1_col2" class="data row1 col2">2.768951</td>
<td id="T_b7e4d_row1_col3" class="data row1 col3">0.005624</td>
<td id="T_b7e4d_row1_col4" class="data row1 col4">With Protected Classes</td>
<td id="T_b7e4d_row1_col5" class="data row1 col5">0.924105</td>
<td id="T_b7e4d_row1_col6" class="data row1 col6">0.006065</td>
</tr>
<tr class="odd">
<td id="T_b7e4d_row2_col0" class="data row2 col0">CategoricalNB</td>
<td id="T_b7e4d_row2_col1" class="data row2 col1">Recall</td>
<td id="T_b7e4d_row2_col2" class="data row2 col2">-21.365216</td>
<td id="T_b7e4d_row2_col3" class="data row2 col3">0.000000</td>
<td id="T_b7e4d_row2_col4" class="data row2 col4">Without Protected Classes</td>
<td id="T_b7e4d_row2_col5" class="data row2 col5">0.948421</td>
<td id="T_b7e4d_row2_col6" class="data row2 col6">0.046966</td>
</tr>
<tr class="even">
<td id="T_b7e4d_row3_col0" class="data row3 col0">CategoricalNB</td>
<td id="T_b7e4d_row3_col1" class="data row3 col1">F1</td>
<td id="T_b7e4d_row3_col2" class="data row3 col2">-9.276604</td>
<td id="T_b7e4d_row3_col3" class="data row3 col3">0.000000</td>
<td id="T_b7e4d_row3_col4" class="data row3 col4">Without Protected Classes</td>
<td id="T_b7e4d_row3_col5" class="data row3 col5">0.932983</td>
<td id="T_b7e4d_row3_col6" class="data row3 col6">0.020344</td>
</tr>
<tr class="odd">
<td id="T_b7e4d_row4_col0" class="data row4 col0">CategoricalNB</td>
<td id="T_b7e4d_row4_col1" class="data row4 col1">ROC-AUC</td>
<td id="T_b7e4d_row4_col2" class="data row4 col2">1.049461</td>
<td id="T_b7e4d_row4_col3" class="data row4 col3">0.293966</td>
<td id="T_b7e4d_row4_col4" class="data row4 col4">With Protected Classes</td>
<td id="T_b7e4d_row4_col5" class="data row4 col5">0.731962</td>
<td id="T_b7e4d_row4_col6" class="data row4 col6">0.007958</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="multinomial-naive-bayes-1" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="multinomial-naive-bayes-1"><span class="header-section-number">7.3.2</span> Multinomial Naive Bayes</h3>
<div id="cell-fig-mnb-1" class="cell" data-execution_count="39">
<div class="cell-output cell-output-display">
<div id="fig-mnb-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nb_files/figure-html/fig-mnb-1-output-1.png" width="670" height="475" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: Confusion Matrices (MultinomialNB, Single-Run)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="40">
<div id="tbl-mnb-1" class="cell quarto-float anchored" data-execution_count="40">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.22: Model Performance Metrics (MultinomialNB, Single Run)
</figcaption>
<div aria-describedby="tbl-mnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_360ea" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_360ea_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_360ea_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Data</th>
<th id="T_360ea_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Accuracy</th>
<th id="T_360ea_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Precision</th>
<th id="T_360ea_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Recall</th>
<th id="T_360ea_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">F1</th>
<th id="T_360ea_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">ROC-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_360ea_row0_col0" class="data row0 col0">MultinomialNB</td>
<td id="T_360ea_row0_col1" class="data row0 col1">With Protected Classes</td>
<td id="T_360ea_row0_col2" class="data row0 col2">0.936358</td>
<td id="T_360ea_row0_col3" class="data row0 col3">0.967880</td>
<td id="T_360ea_row0_col4" class="data row0 col4">0.957361</td>
<td id="T_360ea_row0_col5" class="data row0 col5">0.962591</td>
<td id="T_360ea_row0_col6" class="data row0 col6">0.884798</td>
</tr>
<tr class="even">
<td id="T_360ea_row1_col0" class="data row1 col0">MultinomialNB</td>
<td id="T_360ea_row1_col1" class="data row1 col1">Without Protected Classes</td>
<td id="T_360ea_row1_col2" class="data row1 col2">0.939653</td>
<td id="T_360ea_row1_col3" class="data row1 col3">0.969309</td>
<td id="T_360ea_row1_col4" class="data row1 col4">0.959833</td>
<td id="T_360ea_row1_col5" class="data row1 col5">0.964548</td>
<td id="T_360ea_row1_col6" class="data row1 col6">0.890112</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="cell-fig-mnb-2" class="cell" data-execution_count="41">
<div class="cell-output cell-output-display">
<div id="fig-mnb-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nb_files/figure-html/fig-mnb-2-output-1.png" width="1086" height="577" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.4: Metric Kernel Density Estimates (500 randomizations, MultinomialNB)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div id="tbl-mnb-2" class="cell quarto-float anchored" data-execution_count="42">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.23: Statistical Significance Tests (Model Performance Metrics, MultinomialNB)
</figcaption>
<div aria-describedby="tbl-mnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_f2696" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_f2696_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_f2696_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Stat</th>
<th id="T_f2696_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">z-score</th>
<th id="T_f2696_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">p-value</th>
<th id="T_f2696_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">top performer</th>
<th id="T_f2696_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">top mean</th>
<th id="T_f2696_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">difference in means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_f2696_row0_col0" class="data row0 col0">MultinomialNB</td>
<td id="T_f2696_row0_col1" class="data row0 col1">Accuracy</td>
<td id="T_f2696_row0_col2" class="data row0 col2">-1.242399</td>
<td id="T_f2696_row0_col3" class="data row0 col3">0.214090</td>
<td id="T_f2696_row0_col4" class="data row0 col4">Without Protected Classes</td>
<td id="T_f2696_row0_col5" class="data row0 col5">0.804602</td>
<td id="T_f2696_row0_col6" class="data row0 col6">0.000175</td>
</tr>
<tr class="even">
<td id="T_f2696_row1_col0" class="data row1 col0">MultinomialNB</td>
<td id="T_f2696_row1_col1" class="data row1 col1">Precision</td>
<td id="T_f2696_row1_col2" class="data row1 col2">12.735062</td>
<td id="T_f2696_row1_col3" class="data row1 col3">0.000000</td>
<td id="T_f2696_row1_col4" class="data row1 col4">With Protected Classes</td>
<td id="T_f2696_row1_col5" class="data row1 col5">0.914013</td>
<td id="T_f2696_row1_col6" class="data row1 col6">0.000778</td>
</tr>
<tr class="odd">
<td id="T_f2696_row2_col0" class="data row2 col0">MultinomialNB</td>
<td id="T_f2696_row2_col1" class="data row2 col1">Recall</td>
<td id="T_f2696_row2_col2" class="data row2 col2">-7.701771</td>
<td id="T_f2696_row2_col3" class="data row2 col3">0.000000</td>
<td id="T_f2696_row2_col4" class="data row2 col4">Without Protected Classes</td>
<td id="T_f2696_row2_col5" class="data row2 col5">0.852538</td>
<td id="T_f2696_row2_col6" class="data row2 col6">0.001103</td>
</tr>
<tr class="even">
<td id="T_f2696_row3_col0" class="data row3 col0">MultinomialNB</td>
<td id="T_f2696_row3_col1" class="data row3 col1">F1</td>
<td id="T_f2696_row3_col2" class="data row3 col2">-2.489032</td>
<td id="T_f2696_row3_col3" class="data row3 col3">0.012809</td>
<td id="T_f2696_row3_col4" class="data row3 col4">Without Protected Classes</td>
<td id="T_f2696_row3_col5" class="data row3 col5">0.881842</td>
<td id="T_f2696_row3_col6" class="data row3 col6">0.000228</td>
</tr>
<tr class="odd">
<td id="T_f2696_row4_col0" class="data row4 col0">MultinomialNB</td>
<td id="T_f2696_row4_col1" class="data row4 col1">ROC-AUC</td>
<td id="T_f2696_row4_col2" class="data row4 col2">10.578913</td>
<td id="T_f2696_row4_col3" class="data row4 col3">0.000000</td>
<td id="T_f2696_row4_col4" class="data row4 col4">With Protected Classes</td>
<td id="T_f2696_row4_col5" class="data row4 col5">0.689026</td>
<td id="T_f2696_row4_col6" class="data row4 col6">0.002104</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="bernoulli-naive-bayes-2" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="bernoulli-naive-bayes-2"><span class="header-section-number">7.3.3</span> Bernoulli Naive Bayes</h3>
<div id="cell-fig-bnb-1" class="cell" data-execution_count="43">
<div class="cell-output cell-output-display">
<div id="fig-bnb-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nb_files/figure-html/fig-bnb-1-output-1.png" width="670" height="475" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.5: Confusion Matrices (BernoulliNB, Single-Run)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div id="tbl-bnb-1" class="cell quarto-float anchored" data-execution_count="44">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.24: Model Performance Metrics (BernoulliNB, Single Run)
</figcaption>
<div aria-describedby="tbl-bnb-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_74fea" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_74fea_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_74fea_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Data</th>
<th id="T_74fea_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Accuracy</th>
<th id="T_74fea_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Precision</th>
<th id="T_74fea_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Recall</th>
<th id="T_74fea_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">F1</th>
<th id="T_74fea_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">ROC-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_74fea_row0_col0" class="data row0 col0">BernoulliNB</td>
<td id="T_74fea_row0_col1" class="data row0 col1">With Protected Classes</td>
<td id="T_74fea_row0_col2" class="data row0 col2">0.937514</td>
<td id="T_74fea_row0_col3" class="data row0 col3">0.973560</td>
<td id="T_74fea_row0_col4" class="data row0 col4">0.952818</td>
<td id="T_74fea_row0_col5" class="data row0 col5">0.963077</td>
<td id="T_74fea_row0_col6" class="data row0 col6">0.899943</td>
</tr>
<tr class="even">
<td id="T_74fea_row1_col0" class="data row1 col0">BernoulliNB</td>
<td id="T_74fea_row1_col1" class="data row1 col1">Without Protected Classes</td>
<td id="T_74fea_row1_col2" class="data row1 col2">0.939875</td>
<td id="T_74fea_row1_col3" class="data row1 col3">0.977551</td>
<td id="T_74fea_row1_col4" class="data row1 col4">0.951553</td>
<td id="T_74fea_row1_col5" class="data row1 col5">0.964377</td>
<td id="T_74fea_row1_col6" class="data row1 col6">0.911205</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="cell-fig-bnb-2" class="cell" data-execution_count="45">
<div class="cell-output cell-output-display">
<div id="fig-bnb-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="nb_files/figure-html/fig-bnb-2-output-1.png" width="1086" height="577" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.6: Metric Kernel Density Estimates (500 randomizations, BernoulliNB)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="46">
<div id="tbl-bnb-2" class="cell quarto-float anchored" data-execution_count="46">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.25: Statistical Significance Tests (Model Performance Metrics, BernoulliNB)
</figcaption>
<div aria-describedby="tbl-bnb-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_e9068" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_e9068_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_e9068_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Stat</th>
<th id="T_e9068_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">z-score</th>
<th id="T_e9068_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">p-value</th>
<th id="T_e9068_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">top performer</th>
<th id="T_e9068_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">top mean</th>
<th id="T_e9068_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">difference in means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_e9068_row0_col0" class="data row0 col0">BernoulliNB</td>
<td id="T_e9068_row0_col1" class="data row0 col1">Accuracy</td>
<td id="T_e9068_row0_col2" class="data row0 col2">-53.447073</td>
<td id="T_e9068_row0_col3" class="data row0 col3">0.000000</td>
<td id="T_e9068_row0_col4" class="data row0 col4">Without Protected Classes</td>
<td id="T_e9068_row0_col5" class="data row0 col5">0.940754</td>
<td id="T_e9068_row0_col6" class="data row0 col6">0.003477</td>
</tr>
<tr class="even">
<td id="T_e9068_row1_col0" class="data row1 col0">BernoulliNB</td>
<td id="T_e9068_row1_col1" class="data row1 col1">Precision</td>
<td id="T_e9068_row1_col2" class="data row1 col2">-44.319309</td>
<td id="T_e9068_row1_col3" class="data row1 col3">0.000000</td>
<td id="T_e9068_row1_col4" class="data row1 col4">Without Protected Classes</td>
<td id="T_e9068_row1_col5" class="data row1 col5">0.969658</td>
<td id="T_e9068_row1_col6" class="data row1 col6">0.002109</td>
</tr>
<tr class="odd">
<td id="T_e9068_row2_col0" class="data row2 col0">BernoulliNB</td>
<td id="T_e9068_row2_col1" class="data row2 col1">Recall</td>
<td id="T_e9068_row2_col2" class="data row2 col2">-31.047924</td>
<td id="T_e9068_row2_col3" class="data row2 col3">0.000000</td>
<td id="T_e9068_row2_col4" class="data row2 col4">Without Protected Classes</td>
<td id="T_e9068_row2_col5" class="data row2 col5">0.960794</td>
<td id="T_e9068_row2_col6" class="data row2 col6">0.001971</td>
</tr>
<tr class="even">
<td id="T_e9068_row3_col0" class="data row3 col0">BernoulliNB</td>
<td id="T_e9068_row3_col1" class="data row3 col1">F1</td>
<td id="T_e9068_row3_col2" class="data row3 col2">-52.811800</td>
<td id="T_e9068_row3_col3" class="data row3 col3">0.000000</td>
<td id="T_e9068_row3_col4" class="data row3 col4">Without Protected Classes</td>
<td id="T_e9068_row3_col5" class="data row3 col5">0.965205</td>
<td id="T_e9068_row3_col6" class="data row3 col6">0.002040</td>
</tr>
<tr class="odd">
<td id="T_e9068_row4_col0" class="data row4 col0">BernoulliNB</td>
<td id="T_e9068_row4_col1" class="data row4 col1">ROC-AUC</td>
<td id="T_e9068_row4_col2" class="data row4 col2">-49.602472</td>
<td id="T_e9068_row4_col3" class="data row4 col3">0.000000</td>
<td id="T_e9068_row4_col4" class="data row4 col4">Without Protected Classes</td>
<td id="T_e9068_row4_col5" class="data row4 col5">0.891554</td>
<td id="T_e9068_row4_col6" class="data row4 col6">0.007172</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="overall" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="overall"><span class="header-section-number">7.3.4</span> Overall</h3>
<div class="cell" data-execution_count="47">
<div id="tbl-summary-results" class="cell quarto-float anchored" data-execution_count="47">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.26: Summary of single-run model performance outcomes
</figcaption>
<div aria-describedby="tbl-summary-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_19da2" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_19da2_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_19da2_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Data</th>
<th id="T_19da2_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Accuracy</th>
<th id="T_19da2_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Precision</th>
<th id="T_19da2_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Recall</th>
<th id="T_19da2_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">F1</th>
<th id="T_19da2_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">ROC-AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_19da2_row0_col0" class="data row0 col0">CategoricalNB</td>
<td id="T_19da2_row0_col1" class="data row0 col1">With Protected Classes</td>
<td id="T_19da2_row0_col2" class="data row0 col2">0.882012</td>
<td id="T_19da2_row0_col3" class="data row0 col3">0.943416</td>
<td id="T_19da2_row0_col4" class="data row0 col4">0.917050</td>
<td id="T_19da2_row0_col5" class="data row0 col5">0.930046</td>
<td id="T_19da2_row0_col6" class="data row0 col6">0.795993</td>
</tr>
<tr class="even">
<td id="T_19da2_row1_col0" class="data row1 col0">CategoricalNB</td>
<td id="T_19da2_row1_col1" class="data row1 col1">Without Protected Classes</td>
<td id="T_19da2_row1_col2" class="data row1 col2">0.912455</td>
<td id="T_19da2_row1_col3" class="data row1 col3">0.934819</td>
<td id="T_19da2_row1_col4" class="data row1 col4">0.964922</td>
<td id="T_19da2_row1_col5" class="data row1 col5">0.949632</td>
<td id="T_19da2_row1_col6" class="data row1 col6">0.783651</td>
</tr>
<tr class="odd">
<td id="T_19da2_row2_col0" class="data row2 col0">MultinomialNB</td>
<td id="T_19da2_row2_col1" class="data row2 col1">With Protected Classes</td>
<td id="T_19da2_row2_col2" class="data row2 col2">0.936358</td>
<td id="T_19da2_row2_col3" class="data row2 col3">0.967880</td>
<td id="T_19da2_row2_col4" class="data row2 col4">0.957361</td>
<td id="T_19da2_row2_col5" class="data row2 col5">0.962591</td>
<td id="T_19da2_row2_col6" class="data row2 col6">0.884798</td>
</tr>
<tr class="even">
<td id="T_19da2_row3_col0" class="data row3 col0">MultinomialNB</td>
<td id="T_19da2_row3_col1" class="data row3 col1">Without Protected Classes</td>
<td id="T_19da2_row3_col2" class="data row3 col2">0.939653</td>
<td id="T_19da2_row3_col3" class="data row3 col3">0.969309</td>
<td id="T_19da2_row3_col4" class="data row3 col4">0.959833</td>
<td id="T_19da2_row3_col5" class="data row3 col5">0.964548</td>
<td id="T_19da2_row3_col6" class="data row3 col6">0.890112</td>
</tr>
<tr class="odd">
<td id="T_19da2_row4_col0" class="data row4 col0">BernoulliNB</td>
<td id="T_19da2_row4_col1" class="data row4 col1">With Protected Classes</td>
<td id="T_19da2_row4_col2" class="data row4 col2">0.937514</td>
<td id="T_19da2_row4_col3" class="data row4 col3">0.973560</td>
<td id="T_19da2_row4_col4" class="data row4 col4">0.952818</td>
<td id="T_19da2_row4_col5" class="data row4 col5">0.963077</td>
<td id="T_19da2_row4_col6" class="data row4 col6">0.899943</td>
</tr>
<tr class="even">
<td id="T_19da2_row5_col0" class="data row5 col0">BernoulliNB</td>
<td id="T_19da2_row5_col1" class="data row5 col1">Without Protected Classes</td>
<td id="T_19da2_row5_col2" class="data row5 col2">0.939875</td>
<td id="T_19da2_row5_col3" class="data row5 col3">0.977551</td>
<td id="T_19da2_row5_col4" class="data row5 col4">0.951553</td>
<td id="T_19da2_row5_col5" class="data row5 col5">0.964377</td>
<td id="T_19da2_row5_col6" class="data row5 col6">0.911205</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="48">
<div id="tbl-summary-stats" class="cell quarto-float anchored" data-execution_count="48">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.27: Summary of 500 Randomization Test Outcomes (All Model Types)
</figcaption>
<div aria-describedby="tbl-summary-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<style type="text/css">
</style>

<table id="T_52668" class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th id="T_52668_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th id="T_52668_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Stat</th>
<th id="T_52668_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">z-score</th>
<th id="T_52668_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">p-value</th>
<th id="T_52668_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">top performer</th>
<th id="T_52668_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">top mean</th>
<th id="T_52668_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">difference in means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_52668_row0_col0" class="data row0 col0">BernoulliNB</td>
<td id="T_52668_row0_col1" class="data row0 col1">Precision</td>
<td id="T_52668_row0_col2" class="data row0 col2">-44.319309</td>
<td id="T_52668_row0_col3" class="data row0 col3">0.000000</td>
<td id="T_52668_row0_col4" class="data row0 col4">Without Protected Classes</td>
<td id="T_52668_row0_col5" class="data row0 col5">0.969658</td>
<td id="T_52668_row0_col6" class="data row0 col6">0.002109</td>
</tr>
<tr class="even">
<td id="T_52668_row1_col0" class="data row1 col0">BernoulliNB</td>
<td id="T_52668_row1_col1" class="data row1 col1">F1</td>
<td id="T_52668_row1_col2" class="data row1 col2">-52.811800</td>
<td id="T_52668_row1_col3" class="data row1 col3">0.000000</td>
<td id="T_52668_row1_col4" class="data row1 col4">Without Protected Classes</td>
<td id="T_52668_row1_col5" class="data row1 col5">0.965205</td>
<td id="T_52668_row1_col6" class="data row1 col6">0.002040</td>
</tr>
<tr class="odd">
<td id="T_52668_row2_col0" class="data row2 col0">BernoulliNB</td>
<td id="T_52668_row2_col1" class="data row2 col1">Recall</td>
<td id="T_52668_row2_col2" class="data row2 col2">-31.047924</td>
<td id="T_52668_row2_col3" class="data row2 col3">0.000000</td>
<td id="T_52668_row2_col4" class="data row2 col4">Without Protected Classes</td>
<td id="T_52668_row2_col5" class="data row2 col5">0.960794</td>
<td id="T_52668_row2_col6" class="data row2 col6">0.001971</td>
</tr>
<tr class="even">
<td id="T_52668_row3_col0" class="data row3 col0">CategoricalNB</td>
<td id="T_52668_row3_col1" class="data row3 col1">Recall</td>
<td id="T_52668_row3_col2" class="data row3 col2">-21.365216</td>
<td id="T_52668_row3_col3" class="data row3 col3">0.000000</td>
<td id="T_52668_row3_col4" class="data row3 col4">Without Protected Classes</td>
<td id="T_52668_row3_col5" class="data row3 col5">0.948421</td>
<td id="T_52668_row3_col6" class="data row3 col6">0.046966</td>
</tr>
<tr class="odd">
<td id="T_52668_row4_col0" class="data row4 col0">BernoulliNB</td>
<td id="T_52668_row4_col1" class="data row4 col1">Accuracy</td>
<td id="T_52668_row4_col2" class="data row4 col2">-53.447073</td>
<td id="T_52668_row4_col3" class="data row4 col3">0.000000</td>
<td id="T_52668_row4_col4" class="data row4 col4">Without Protected Classes</td>
<td id="T_52668_row4_col5" class="data row4 col5">0.940754</td>
<td id="T_52668_row4_col6" class="data row4 col6">0.003477</td>
</tr>
<tr class="even">
<td id="T_52668_row5_col0" class="data row5 col0">CategoricalNB</td>
<td id="T_52668_row5_col1" class="data row5 col1">F1</td>
<td id="T_52668_row5_col2" class="data row5 col2">-9.276604</td>
<td id="T_52668_row5_col3" class="data row5 col3">0.000000</td>
<td id="T_52668_row5_col4" class="data row5 col4">Without Protected Classes</td>
<td id="T_52668_row5_col5" class="data row5 col5">0.932983</td>
<td id="T_52668_row5_col6" class="data row5 col6">0.020344</td>
</tr>
<tr class="odd">
<td id="T_52668_row6_col0" class="data row6 col0">CategoricalNB</td>
<td id="T_52668_row6_col1" class="data row6 col1">Precision</td>
<td id="T_52668_row6_col2" class="data row6 col2">2.768951</td>
<td id="T_52668_row6_col3" class="data row6 col3">0.005624</td>
<td id="T_52668_row6_col4" class="data row6 col4">With Protected Classes</td>
<td id="T_52668_row6_col5" class="data row6 col5">0.924105</td>
<td id="T_52668_row6_col6" class="data row6 col6">0.006065</td>
</tr>
<tr class="even">
<td id="T_52668_row7_col0" class="data row7 col0">MultinomialNB</td>
<td id="T_52668_row7_col1" class="data row7 col1">Precision</td>
<td id="T_52668_row7_col2" class="data row7 col2">12.735062</td>
<td id="T_52668_row7_col3" class="data row7 col3">0.000000</td>
<td id="T_52668_row7_col4" class="data row7 col4">With Protected Classes</td>
<td id="T_52668_row7_col5" class="data row7 col5">0.914013</td>
<td id="T_52668_row7_col6" class="data row7 col6">0.000778</td>
</tr>
<tr class="odd">
<td id="T_52668_row8_col0" class="data row8 col0">BernoulliNB</td>
<td id="T_52668_row8_col1" class="data row8 col1">ROC-AUC</td>
<td id="T_52668_row8_col2" class="data row8 col2">-49.602472</td>
<td id="T_52668_row8_col3" class="data row8 col3">0.000000</td>
<td id="T_52668_row8_col4" class="data row8 col4">Without Protected Classes</td>
<td id="T_52668_row8_col5" class="data row8 col5">0.891554</td>
<td id="T_52668_row8_col6" class="data row8 col6">0.007172</td>
</tr>
<tr class="even">
<td id="T_52668_row9_col0" class="data row9 col0">CategoricalNB</td>
<td id="T_52668_row9_col1" class="data row9 col1">Accuracy</td>
<td id="T_52668_row9_col2" class="data row9 col2">-8.271750</td>
<td id="T_52668_row9_col3" class="data row9 col3">0.000000</td>
<td id="T_52668_row9_col4" class="data row9 col4">Without Protected Classes</td>
<td id="T_52668_row9_col5" class="data row9 col5">0.883466</td>
<td id="T_52668_row9_col6" class="data row9 col6">0.031069</td>
</tr>
<tr class="odd">
<td id="T_52668_row10_col0" class="data row10 col0">MultinomialNB</td>
<td id="T_52668_row10_col1" class="data row10 col1">F1</td>
<td id="T_52668_row10_col2" class="data row10 col2">-2.489032</td>
<td id="T_52668_row10_col3" class="data row10 col3">0.012809</td>
<td id="T_52668_row10_col4" class="data row10 col4">Without Protected Classes</td>
<td id="T_52668_row10_col5" class="data row10 col5">0.881842</td>
<td id="T_52668_row10_col6" class="data row10 col6">0.000228</td>
</tr>
<tr class="even">
<td id="T_52668_row11_col0" class="data row11 col0">MultinomialNB</td>
<td id="T_52668_row11_col1" class="data row11 col1">Recall</td>
<td id="T_52668_row11_col2" class="data row11 col2">-7.701771</td>
<td id="T_52668_row11_col3" class="data row11 col3">0.000000</td>
<td id="T_52668_row11_col4" class="data row11 col4">Without Protected Classes</td>
<td id="T_52668_row11_col5" class="data row11 col5">0.852538</td>
<td id="T_52668_row11_col6" class="data row11 col6">0.001103</td>
</tr>
<tr class="odd">
<td id="T_52668_row12_col0" class="data row12 col0">MultinomialNB</td>
<td id="T_52668_row12_col1" class="data row12 col1">Accuracy</td>
<td id="T_52668_row12_col2" class="data row12 col2">-1.242399</td>
<td id="T_52668_row12_col3" class="data row12 col3">0.214090</td>
<td id="T_52668_row12_col4" class="data row12 col4">Without Protected Classes</td>
<td id="T_52668_row12_col5" class="data row12 col5">0.804602</td>
<td id="T_52668_row12_col6" class="data row12 col6">0.000175</td>
</tr>
<tr class="even">
<td id="T_52668_row13_col0" class="data row13 col0">CategoricalNB</td>
<td id="T_52668_row13_col1" class="data row13 col1">ROC-AUC</td>
<td id="T_52668_row13_col2" class="data row13 col2">1.049461</td>
<td id="T_52668_row13_col3" class="data row13 col3">0.293966</td>
<td id="T_52668_row13_col4" class="data row13 col4">With Protected Classes</td>
<td id="T_52668_row13_col5" class="data row13 col5">0.731962</td>
<td id="T_52668_row13_col6" class="data row13 col6">0.007958</td>
</tr>
<tr class="odd">
<td id="T_52668_row14_col0" class="data row14 col0">MultinomialNB</td>
<td id="T_52668_row14_col1" class="data row14 col1">ROC-AUC</td>
<td id="T_52668_row14_col2" class="data row14 col2">10.578913</td>
<td id="T_52668_row14_col3" class="data row14 col3">0.000000</td>
<td id="T_52668_row14_col4" class="data row14 col4">With Protected Classes</td>
<td id="T_52668_row14_col5" class="data row14 col5">0.689026</td>
<td id="T_52668_row14_col6" class="data row14 col6">0.002104</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Examining the above figures and tables for each model type, performance metrics, and the distribution of performance metrics across 500 random trials, several findings are evident:</p>
<ul>
<li><p>Bernoulli Naive Bayes is the best performing across all performance metrics at 89.1-96.5% as the mean metric score. In <a href="#tbl-summary-stats" class="quarto-xref">Table&nbsp;<span>7.27</span></a>, the performance is sorted by the top mean metric in descending order. For all stats, BernoulliNB outperforms Categorical and Multinomial naive bayes models.</p></li>
<li><p>There are statistically significant differences in model performance for nearly all performance metrics, across all naive bayes model types (exceptions: CategoricalNB Precision, CategoricalNB ROC-AUC)</p></li>
<li><p>The difference in mean performance metrics, where significant, is less than 4% across all hypothesis tests.</p></li>
</ul>
<p>These findings are revealing. First and foremost, if a naive bayes model were to be employed, it should be the Bernoulli format, regardless of what data is included. This can be of use in future modeling efforts. It effectively examines whether or not a record meets a specific set of conditions that support a conclusion of approval or denial of a loan.</p>
<p>Furthermore, in the case of Bernoulli naive bayes, there is a statistically significant outcome in favor of the <em>exclusion</em> of protected class information to deliver higher model performance (with metrics ranging from 0.07%-1% higher).</p>
<p>Were a financial institution to instead employ CategoricalNB or MultinomialNB, they would be doing themselves a disservice in terms of model performance. However, they do have access to additional variables and information not available to the general public, and may find that either of these models serve their predictive needs better than BernoulliNB.</p>
<p>That being the case - for each of these models, there are cases with statistically significant outcomes where the models perform better when protected class information is included in the training and testing data:</p>
<div id="42cda273" class="cell" data-execution_count="49">
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">Stat</th>
<th data-quarto-table-cell-role="th">z-score</th>
<th data-quarto-table-cell-role="th">p-value</th>
<th data-quarto-table-cell-role="th">top performer</th>
<th data-quarto-table-cell-role="th">top mean</th>
<th data-quarto-table-cell-role="th">difference in means</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>CategoricalNB</td>
<td>Precision</td>
<td>2.768951</td>
<td>5.623710e-03</td>
<td>With Protected Classes</td>
<td>0.924105</td>
<td>0.006065</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>CategoricalNB</td>
<td>ROC-AUC</td>
<td>1.049461</td>
<td>2.939661e-01</td>
<td>With Protected Classes</td>
<td>0.731962</td>
<td>0.007958</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>MultinomialNB</td>
<td>Precision</td>
<td>12.735062</td>
<td>3.775460e-37</td>
<td>With Protected Classes</td>
<td>0.914013</td>
<td>0.000778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>MultinomialNB</td>
<td>ROC-AUC</td>
<td>10.578913</td>
<td>3.732618e-26</td>
<td>With Protected Classes</td>
<td>0.689026</td>
<td>0.002104</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>When the better performing model includes protected class information, one can clearly see that, while statistically significant, the difference in means between the models is <em>less than 1%</em>. With such a slight difference, performance gain by incorporating these features is not justified, and from an operational standpoint, the features can be excluded from models with minimal impact to effective predictions.</p>
<!-- 
The results across all naive bayes model types (Categorical, Multinomial, and Bernoulli) staggeringly favor the *exclusion* of protected class information in the prediction of whether or not a mortgage application should receive approval.  In all cases of a statistically significant difference in metrics (accuracy, precision, recall, F1, and ROC-AUC), the model trained with  -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./arm.html" class="pagination-link  aria-label=" &lt;span="" rule="" mining&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Association Rule Mining</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./dt.html" class="pagination-link" aria-label="<span class='chapter-number'>8</span>&nbsp; <span class='chapter-title'>Decision Tree Modeling</span>">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Decision Tree Modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploring Protected Classes as Predictors in Mortgage Approval - 5&nbsp; Association Rule Mining</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./clustering.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./arm.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Association Rule Mining</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Exploring Protected Classes as Predictors in Mortgage Approval</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/pconnell/ML" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./ML-Final-Report.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Gathering and Exploratory Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Principal Component Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Association Rule Mining</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Data Gathering/Cleaning Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Component Analysis Code (PCA and MCA)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Association Rule Mining Code</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">5.1</span> Overview</a></li>
  <li><a href="#arm-within-this-study" id="toc-arm-within-this-study" class="nav-link" data-scroll-target="#arm-within-this-study"><span class="header-section-number">5.2</span> ARM within this Study</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">5.3</span> Data</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code"><span class="header-section-number">5.4</span> Code</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">5.5</span> Results</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">5.6</span> Conclusions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-ARM" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Association Rule Mining</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">5.1</span> Overview</h2>
<!-- Describe arm -->
<p>Association Rule Mining, henceforth ARM in this section, is the process of identifying commonly occuring combinations within a dataset. The method allows one to explore and uncover potentially unknown associations and groupings in data that are not necessarily immediately evident upon a direct human inspection.</p>
<p>A common application of these methods is that of assessing common purchases by customers in a store or e-commerce website (e.g.&nbsp;if a customer buys a portable music player, is it common or frequent for those customers to purchase a USB cable, or Bluetooth headphones, or potentially both?). Manually inspecting or searching through the data with ad-hoc or independently built algorithms may not be effective or efficient to identify such patterns. When considering an application such as customer purchases, or transactional data, the possibility of combinations of items in each purchase is conceptually unbounded, and using brute-force methods to seek out these combinations will exceed the available computational resources of a machine before identifying anything of use.</p>
<p>So, to examine transactions for potentially insightful or useful metrics, one needs to go about said search wisely and efficiently. This is where a handful of algorithms and methods come into play, including Frequent Pattern growth and Apriori.</p>
<p><em>What is a frequent pattern?</em></p>
<p>A frequent pattern is defined as a collection of items that occur at or above a specified threshold within a dataset of transactions. When measuring frequent patterns, each item in the collection is unique, and multiple instances of the same item within an individual transaction are ignored so as to bring focus on the occurence of unique items being grouped together within the dataset. Since the threshold can be specified by the person conducting association rule mining, <em>frequent</em> is a relative and subjective term in this context, as it is based on the relative frequency of occurence of the group of items, and whether or not that relative frequency exceeds an arbitrary threshold.</p>
<p>Common items that are connected, grouped, or bundled together are be referred to as <em>frequent patterns</em> within datasets.</p>
<p><em>How does apriori work?</em></p>
<p>The Apriori algorithm leverages bayesian probability and induction to… To perform apriori ARM, one must set thresholds for the metric for which one is measuring the data. This is key, because depending on the number of unique items or the number of transactions within the dataset in question, the</p>
<p>To search for these connections and associations, the method leverages Bayes rule for probability, metrics such as entropy or Gini indices within the Apriori algorithm. The algorithm iteratively and inductively examines data for frequent patterns, generally, in the following manner -</p>
<ol type="1">
<li><p>Calculate or determine the relative frequency of item groups or sets of length 1 (based on input threshold).</p></li>
<li><p>Prune items that do not meet the input threshold from further consideration.</p></li>
<li><p>For patterns of length <span class="math inline">\(n\)</span>, examine combinations of frequent patterns with length <span class="math inline">\(n-1\)</span> and length 1 (e.g.&nbsp;for length 2, combine frequent item sets of length 1 and 1), and calculate those combinations’ relative frequencies.</p></li>
<li><p>Retain only sets of items that meet the initially established threshold.</p></li>
<li><p>Repeat steps 3 and 4 until no more sets of items of length <span class="math inline">\(n\)</span> meet the specified threshold.</p></li>
</ol>
<p>So one can see that as the apriori algorithm proceeds, it does have an eventual halting point, depending on the initially established thresholds. The predominant metric and threshold is the relative frequency of occurence of an item (or combination of items). This relative frequency is also known as the <strong>support</strong> of the combination of items within the dataset.</p>
<p><em>What is an association rule?</em></p>
<p>An association rule goes beyond individual relative frequencies of items or combinations thereof, and begin telling more about how strongly connected certain item combinations are within the data. ARM establishes a connection between an <em>antecedent</em> (or prior) and a <em>consequent</em> (or posterior) set of items within the dataset. The combination of antecedents and consequents are what form assosciation rules. It is similar to asking the question, <em>given</em> a customer has already placed items <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> in their shopping cart, what is the probability or likelihood that they will next place <span class="math inline">\(C\)</span> in their basket? Knowing relative frequencies of individual items and combinations thereof across many transactions is necessary to answer this question, but does not necessarily answer how certain or strong those associations are.</p>
<p><em>How do we measure the strength of the rules?</em></p>
<p>Support has already been discussed in this section as the relative frequency of occurance of a set of items wihtin source data. Strength of association rules are measured with metrics including support, confidence, and lift.</p>
<p>Confidence and lift tell us the most about the strength of a rule. High confidence (ranging from 0 to 1, with 1 being the highest) tell us how often this collection of items occurs.</p>
<ul>
<li><p><strong>Confidence</strong> - How often the items <strong>A</strong> and <strong>B</strong> occur together given the number of times <strong>A</strong> occurs. Helps us in that if someone is just buying <strong>A</strong> and <strong>B</strong> together and not <strong>C</strong>, we can rule out <strong>C</strong> at that point in time. <span class="math inline">\(P(B|A) = \frac{P(A\cap B)}{P(A)}\)</span></p></li>
<li><p>One can define a threshold for mininum support and confidence as initial parameters when beginning to build association rules. Once set these values are set, they serve as a filter that adjusts the number of rules that are found, and helps determine how long or specific those rules can be. Generally, since the algorithm is inductive, lengthy rules are rare (e.g.&nbsp;will have low support). By setting lower initial thresholds for support, more rules can be mined.</p></li>
<li><p><strong>Lift</strong> - gives us the indepdendent occurence probability of item <strong>A</strong> and <strong>B</strong>. We observe that there is alot of between this random occurence and association. <span class="math inline">\(\frac{P(A\cap B)}{P(A)\cdot P(B)}\)</span></p>
<ul>
<li><p>The calculation of lift is based upon the assumption of statistical independence - <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are indpendent <span class="math inline">\(\iff\)</span> <span class="math inline">\(P(A\cap B) = P(A)\cdot P(B)\)</span>. So, with the fraction <span class="math inline">\(\frac{P(A\cap B)}{P(A)\cdot P(B)}\)</span>, it transforms the calculation in such a way we can garner important insight.</p></li>
<li><p>Lift values equal to 1 signify item occurences that are independent of one another.</p></li>
<li><p>Lift values greater than 1 are akin to saying the sum is greater than its parts, and gives greater creedence to a calculated confidence value. The higher lift is, the more assurance that we have that the confidence is meaningful and impactful.</p></li>
<li><p>Lift values less than 1 signify that there is an inverse relationship between the items in question, and that having one actually reduces the chances of the other occuring. The closer to zero this value approaches, the stronger the inverse relationship is.</p></li>
</ul></li>
</ul>
<p><em>How does one interpret association rules?</em></p>
<p>ARM does <strong>not</strong> establish causal relationships between antecedents and consequents. It is a frequentist method to examine relative probabilities within transaction data. When interpreting association rules, one can comment on the strength of identified rules using metrics like confidence and lift. Lift values for association rules are tantamount to pearson R correlation values with some differences in the range of the potential result:</p>
<ul>
<li><p>a lift value substantially higher than 1 is analogous to a high, positive Pearson R value close to +1</p></li>
<li><p>a small lift value, very close to 0, is analogous to a low, negative Pearson R value close to -1</p></li>
<li><p>a lift value of 1 is analogous to a Pearson R value of 0</p></li>
</ul>
<p>With this similarity to correlation, one can interpret mined rules with high lift and high confidence with statements such as “Customers who buy <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> almost always buy <span class="math inline">\(C\)</span>.” And similarly, for a very low lift and high confidence, “Customers who buy <span class="math inline">\(A\)</span> rarely if ever also buy <span class="math inline">\(B\)</span>.” One should <em>not</em> interpret mined rules in such manners as “Customers buy <span class="math inline">\(B\)</span> <em>because</em> they bought <span class="math inline">\(A\)</span>” or that “Customers who have <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> <em>need</em> <span class="math inline">\(C\)</span>.” The later statements are causal in nature, and such relationships are not established via ARM.</p>
</section>
<section id="arm-within-this-study" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="arm-within-this-study"><span class="header-section-number">5.2</span> ARM within this Study</h2>
<p>ARM for the purpose of this study can help examine some of the findings from the CNN article, and help examine their findings as well as explore other research questions with respect to the top 5 lenders. Examining associations in which the consequent is either a result of loan approval or loan denial is of interest here. Furthermore, performing similar actions where antecedents include the specific financial institution, an individual or collection of protected class information, and other important features should be examined to pursue answers to the research questions established in <a href="index.html" class="quarto-xref"><span>Chapter 1</span></a>.</p>
</section>
<section id="data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="data"><span class="header-section-number">5.3</span> Data</h2>
<p>Applying ARM to the collected HMDA mortgage data is somewhat of a challenge. The data itself is not necessarily organized in a way that is immediately conducive to searching for associations; it contains a mixture of quantitative and qualitative data. To perform ARM, we need transactional data - a list of all things that effectively went into the “basket” of each mortgage application. Additionally, numeric information is a detriment to identifying patterns, as any variable or feature that sits along an interval or continuous scale has countless possibile values which it can take on, and as such, identifying frequent patterns and results in the data may not be possible.</p>
<p>Generally, to prepare this mortgage data for use in ARM, a few actions were necessary to establish features as available and usable:</p>
<ul>
<li><p>perform discretization and binning of numeric variables into distinct categories</p>
<ul>
<li><p>numeric variables were divided on percentile boundaries of width 20, including 0-20, 21-40, 41-60, 61-80, and &gt;80.</p></li>
<li><p>which numeric vars?</p></li>
</ul></li>
<li><p>add features of each mortgage application into a <em>basket</em></p></li>
<li><p>transform the resulting baskets into a one-hot element frame of data</p></li>
<li><p>pivot data into single format (2 columns, transaction number and item)</p></li>
</ul>
<p>The code to perform these transformations and prepare the data was written in Python and can be reviewed in <a href="app4.html" class="quarto-xref"><span>Appendix C</span></a>.</p>
<p>Prior to performing the transaction transformation, the data is the same state as it was after initial collection:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  state_code county_code       derived_sex action_taken purchaser_type
1         OH       39153 Sex Not Available            1              0
2         NY       36061              Male            1              0
3         NY       36061 Sex Not Available            1              0
4         FL       12011              Male            1              0
5         MD       24031             Joint            1              0
6         NC       37089             Joint            1              0</code></pre>
</div>
</div>
<p>Examples of the data, post transformation:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  index                                variable
1     0                                     3.0
2     0 applicant_ethnicity:Not Hispanic/Latino
3     0                            income:21-40
4     0                      interest_rate:0-20
5     0                    applicant_race:White
6     0               loan_to_value_ratio:41-60</code></pre>
</div>
</div>
<p>The transformed data can be found <a href="https://drive.google.com/file/d/1ajAHzTZZMSxuyumuX6bdjtg3w3W1jAEe/view?usp=drive_link">here</a></p>
</section>
<section id="code" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="code"><span class="header-section-number">5.4</span> Code</h2>
<p>The code to prepare the data into single transaction format, execute the apriori algorithm, and measure metrics such as confidence, lift, and support, was written in R is located in <a href="app4.html" class="quarto-xref"><span>Appendix C</span></a>. Furthermore, the code is embedded, but hidden, within the quarto source code of this webpage, written in R. Examination of the source .qmd file will provide a view of the specific code used to generate the rules and visuals.</p>
</section>
<section id="results" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="results"><span class="header-section-number">5.5</span> Results</h2>
<p>The below tables and figures provide insight to mined association rules from the dataset. The overall first three tables, <a href="#tbl-arm-by-spt" class="quarto-xref">Table&nbsp;<span>5.1</span></a>, <a href="#tbl-arm-by-conf" class="quarto-xref">Table&nbsp;<span>5.2</span></a>, and <a href="#tbl-arm-by-lift" class="quarto-xref">Table&nbsp;<span>5.3</span></a> cover the top association rules when the totality of the dataset is mined via apriori.</p>
<p>However, some other tables and figures are necessary to examine the individual institutions, as what is frequent for one institution may be infrequent for another. Being able to dive deeper on the individual institutions and the relative frequency of approvals and denials for their organizations is of interest to the intent of this research.</p>
<div id="tbl-arm-by-spt" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arm-by-spt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: Top 15 Associations by Support
</figcaption>
<div aria-describedby="tbl-arm-by-spt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>     lhs                                           rhs                                         support confidence  coverage     lift  count
[1]  {approve}                                  =&gt; {1 rooms}                                 0.8465587  0.9897986 0.8552837 1.001607 172124
[2]  {1 rooms}                                  =&gt; {approve}                                 0.8465587  0.8566580 0.9882108 1.001607 172124
[3]  {applicant_ethnicity:Not Hispanic/Latino}  =&gt; {1 rooms}                                 0.7152005  0.9893591 0.7228928 1.001162 145416
[4]  {1 rooms}                                  =&gt; {applicant_ethnicity:Not Hispanic/Latino} 0.7152005  0.7237327 0.9882108 1.001162 145416
[5]  {applicant_ethnicity:Not Hispanic/Latino}  =&gt; {approve}                                 0.6253676  0.8650905 0.7228928 1.011466 127151
[6]  {approve}                                  =&gt; {applicant_ethnicity:Not Hispanic/Latino} 0.6253676  0.7311815 0.8552837 1.011466 127151
[7]  {applicant_ethnicity:Not Hispanic/Latino,                                                                                             
      approve}                                  =&gt; {1 rooms}                                 0.6195837  0.9907512 0.6253676 1.002571 125975
[8]  {1 rooms,                                                                                                                             
      applicant_ethnicity:Not Hispanic/Latino}  =&gt; {approve}                                 0.6195837  0.8663077 0.7152005 1.012889 125975
[9]  {1 rooms,                                                                                                                             
      approve}                                  =&gt; {applicant_ethnicity:Not Hispanic/Latino} 0.6195837  0.7318852 0.8465587 1.012439 125975
[10] {applicant_race:White}                     =&gt; {1 rooms}                                 0.6052911  0.9917401 0.6103324 1.003571 123069
[11] {1 rooms}                                  =&gt; {applicant_race:White}                    0.6052911  0.6125121 0.9882108 1.003571 123069
[12] {aus:Desktop Underwriter}                  =&gt; {1 rooms}                                 0.5645626  0.9910383 0.5696678 1.002861 114788
[13] {1 rooms}                                  =&gt; {aus:Desktop Underwriter}                 0.5645626  0.5712977 0.9882108 1.002861 114788
[14] {applicant_race:White}                     =&gt; {approve}                                 0.5349397  0.8764727 0.6103324 1.024774 108765
[15] {approve}                                  =&gt; {applicant_race:White}                    0.5349397  0.6254529 0.8552837 1.024774 108765</code></pre>
</div>
</div>
</figure>
</div>
<p><a href="#tbl-arm-by-spt" class="quarto-xref">Table&nbsp;<span>5.1</span></a> outlines the overall top 15 mined rules by support, or relative frequency. One can see some relatively frequently occurring occurences here, however, this doesn’t mean they are useful or meaningful associations.</p>
<p>For instance, examining rule #14 with an untrained eye would be immediately concerning, as it seems 53% of the time, White applicants are simply approved because they are White. However, examining the lift of this rule being quite close to 1, this is actually a weak association within this data. Recalling that a lift value equal to 1 means that A and B are independent. While this value is greater than one, as are all values in <a href="#tbl-arm-by-spt" class="quarto-xref">Table&nbsp;<span>5.1</span></a>, all of them are very close to 1. As such, every rule in this table is a weak association and simply a result of frequency of presence in the data.</p>
<div id="tbl-arm-by-conf" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arm-by-conf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.2: Top 15 Associations by Confidence
</figcaption>
<div aria-describedby="tbl-arm-by-conf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>     lhs                                         rhs            support confidence   coverage     lift count
[1]  {interest_rate:&gt;80}                      =&gt; {approve}   0.18578904          1 0.18578904 1.169203 37775
[2]  {aus:Loan Prospector/Product Advisor,                                                                  
      aus:Other}                              =&gt; {JP Morgan} 0.15580213          1 0.15580213 4.971320 31678
[3]  {interest_rate:&gt;80,                                                                                    
      loan_to_value_ratio:61-80}              =&gt; {approve}   0.04241056          1 0.04241056 1.169203  8623
[4]  {interest_rate:&gt;80,                                                                                    
      tract_minority_population_percent:0-20} =&gt; {approve}   0.04197283          1 0.04197283 1.169203  8534
[5]  {debt_to_income_ratio:61-80,                                                                           
      interest_rate:&gt;80}                      =&gt; {approve}   0.04571074          1 0.04571074 1.169203  9294
[6]  {interest_rate:&gt;80,                                                                                    
      tract_to_msa_income_percentage:21-40}   =&gt; {approve}   0.04036454          1 0.04036454 1.169203  8207
[7]  {debt_to_income_ratio:21-40,                                                                           
      interest_rate:&gt;80}                      =&gt; {approve}   0.04220891          1 0.04220891 1.169203  8582
[8]  {Female,                                                                                               
      interest_rate:&gt;80}                      =&gt; {approve}   0.04209579          1 0.04209579 1.169203  8559
[9]  {2.0,                                                                                                  
      interest_rate:&gt;80}                      =&gt; {approve}   0.04509104          1 0.04509104 1.169203  9168
[10] {1.0,                                                                                                  
      interest_rate:&gt;80}                      =&gt; {approve}   0.05827702          1 0.05827702 1.169203 11849
[11] {interest_rate:&gt;80,                                                                                    
      loan_to_value_ratio:21-40}              =&gt; {approve}   0.05279802          1 0.05279802 1.169203 10735
[12] {interest_rate:&gt;80,                                                                                    
      Joint}                                  =&gt; {approve}   0.06351993          1 0.06351993 1.169203 12915
[13] {interest_rate:&gt;80,                                                                                    
      Male}                                   =&gt; {approve}   0.06214773          1 0.06214773 1.169203 12636
[14] {aus:Loan Prospector/Product Advisor,                                                                  
      interest_rate:&gt;80}                      =&gt; {approve}   0.08140290          1 0.08140290 1.169203 16551
[15] {interest_rate:&gt;80,                                                                                    
      Rocket Mortgage}                        =&gt; {approve}   0.10214832          1 0.10214832 1.169203 20769</code></pre>
</div>
</div>
</figure>
</div>
<p>In <a href="#tbl-arm-by-conf" class="quarto-xref">Table&nbsp;<span>5.2</span></a>, we have a bit more of a mixed bag of results. The strongest rule is actually the assocation that JP Morgan uses Loan Prospector/Product Advisor and Other Automated underwriting systems for their loan applications, moreseo than any other lender, for 2023 data. This rule (rule #2) has a substantially high value for lift (close to 5) and a confidence of 1, whereas nearly all other rules in this top-15 list are much closer to 1 in terms of lift.</p>
<p>All of these rules have greater lift than the rules mined in <a href="#tbl-arm-by-spt" class="quarto-xref">Table&nbsp;<span>5.1</span></a>, and thus have more utility. However, most are still very close to 1 and not incredibly strong, less rule #2. As such, many of these rules are frequent, but not necessarily meaningful beyond their relative frequency.</p>
<div id="tbl-arm-by-lift" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-arm-by-lift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.3: Top 15 Associations by Lift
</figcaption>
<div aria-describedby="tbl-arm-by-lift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code>     lhs                                                rhs                                      support confidence   coverage     lift count
[1]  {applicant_ethnicity:Mexican}                   =&gt; {applicant_ethnicity:Hispanic/Latino} 0.04056128  0.9169446 0.04423525 8.207934  8247
[2]  {applicant_ethnicity:Hispanic/Latino}           =&gt; {applicant_ethnicity:Mexican}         0.04056128  0.3630800 0.11171442 8.207934  8247
[3]  {1 rooms,                                                                                                                               
      applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.07532387  0.7362273 0.10231062 7.834365 15315
[4]  {applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.07603703  0.7353151 0.10340740 7.824658 15460
[5]  {1 rooms,                                                                                                                               
      applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      approve,                                                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.06595941  0.7333224 0.08994600 7.803453 13411
[6]  {applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      approve,                                                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.06651026  0.7322395 0.09083129 7.791930 13523
[7]  {1 rooms,                                                                                                                               
      applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      aus:Desktop Underwriter,                                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.05100776  0.7264131 0.07021867 7.729930 10371
[8]  {applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      aus:Desktop Underwriter,                                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.05134712  0.7252518 0.07079903 7.717572 10440
[9]  {1 rooms,                                                                                                                               
      applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      approve,                                                                                                                               
      aus:Desktop Underwriter,                                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.04512547  0.7246663 0.06227068 7.711341  9175
[10] {applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      approve,                                                                                                                               
      aus:Desktop Underwriter,                                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.04538122  0.7233459 0.06273792 7.697291  9227
[11] {1 rooms,                                                                                                                               
      applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      approve,                                                                                                                               
      aus:Desktop Underwriter}                       =&gt; {Sex Not Available}                   0.04939456  0.6718625 0.07351885 7.149444 10043
[12] {1 rooms,                                                                                                                               
      applicant_ethnicity:Information Not Provided,                                                                                          
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.07602227  0.6709350 0.11330795 7.139574 15457
[13] {applicant_ethnicity:Information Not Provided,                                                                                          
      applicant_race:Information not provided,                                                                                               
      approve,                                                                                                                               
      aus:Desktop Underwriter}                       =&gt; {Sex Not Available}                   0.04969457  0.6703377 0.07413364 7.133218 10104
[14] {applicant_ethnicity:Information Not Provided,                                                                                          
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.07674034  0.6700880 0.11452278 7.130562 15603
[15] {1 rooms,                                                                                                                               
      applicant_ethnicity:Information Not Provided,                                                                                          
      approve,                                                                                                                               
      Rocket Mortgage}                               =&gt; {Sex Not Available}                   0.06656437  0.6685768 0.09956129 7.114480 13534</code></pre>
</div>
</div>
</figure>
</div>
<div class="cell">
<div id="fig-arm-arules-vis" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-arm-arules-vis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-0b6be5a976126ba58eb0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0b6be5a976126ba58eb0">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"label":["1 rooms","applicant_ethnicity:Hispanic/Latino","applicant_ethnicity:Information Not Provided","applicant_ethnicity:Mexican","applicant_race:Information not provided","approve","aus:Desktop Underwriter","Rocket Mortgage","Sex Not Available","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10","rule 11","rule 12","rule 13","rule 14","rule 15"],"group":[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"value":[1,1,1,1,1,1,1,1,1,1,1,96.12398042414357,98.07544861337682,70.49918433931487,72.00652528548122,29.58564437194128,30.51427406199021,13.48939641109298,14.18923327895595,25.17128874388254,98.03507340946167,25.99225122349102,100,72.15456769983687],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE1B1B","#EE1B1B","#EE6F6F","#EE7272","#EE7878","#EE7B7B","#EE8888","#EE8B8B","#EE8B8B","#EE8E8E","#EED7D7","#EED9D9","#EED9D9","#EED9D9","#EEDCDC"],"title":["1 rooms","applicant_ethnicity:Hispanic/Latino","applicant_ethnicity:Information Not Provided","applicant_ethnicity:Mexican","applicant_race:Information not provided","approve","aus:Desktop Underwriter","Rocket Mortgage","Sex Not Available","<B>[1]<\/B><BR><B>{applicant_ethnicity:Mexican}<\/B><BR>&nbsp;&nbsp; => <B>{applicant_ethnicity:Hispanic/Latino}<\/B><BR><BR>support = 0.0406<BR>confidence = 0.917<BR>coverage = 0.0442<BR>lift = 8.21<BR>count = 8250<BR>order = 2<BR>id = 1","<B>[2]<\/B><BR><B>{applicant_ethnicity:Hispanic/Latino}<\/B><BR>&nbsp;&nbsp; => <B>{applicant_ethnicity:Mexican}<\/B><BR><BR>support = 0.0406<BR>confidence = 0.363<BR>coverage = 0.112<BR>lift = 8.21<BR>count = 8250<BR>order = 2<BR>id = 2","<B>[3]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0753<BR>confidence = 0.736<BR>coverage = 0.102<BR>lift = 7.83<BR>count = 15300<BR>order = 5<BR>id = 3","<B>[4]<\/B><BR><B>{applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.076<BR>confidence = 0.735<BR>coverage = 0.103<BR>lift = 7.82<BR>count = 15500<BR>order = 4<BR>id = 4","<B>[5]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;approve,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.066<BR>confidence = 0.733<BR>coverage = 0.0899<BR>lift = 7.8<BR>count = 13400<BR>order = 6<BR>id = 5","<B>[6]<\/B><BR><B>{applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;approve,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0665<BR>confidence = 0.732<BR>coverage = 0.0908<BR>lift = 7.79<BR>count = 13500<BR>order = 5<BR>id = 6","<B>[7]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.051<BR>confidence = 0.726<BR>coverage = 0.0702<BR>lift = 7.73<BR>count = 10400<BR>order = 6<BR>id = 7","<B>[8]<\/B><BR><B>{applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0513<BR>confidence = 0.725<BR>coverage = 0.0708<BR>lift = 7.72<BR>count = 10400<BR>order = 5<BR>id = 8","<B>[9]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;approve,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0451<BR>confidence = 0.725<BR>coverage = 0.0623<BR>lift = 7.71<BR>count = 9180<BR>order = 7<BR>id = 9","<B>[10]<\/B><BR><B>{applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;approve,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0454<BR>confidence = 0.723<BR>coverage = 0.0627<BR>lift = 7.7<BR>count = 9230<BR>order = 6<BR>id = 10","<B>[11]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;approve,<BR>&nbsp;&nbsp;aus:Desktop Underwriter}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0494<BR>confidence = 0.672<BR>coverage = 0.0735<BR>lift = 7.15<BR>count = 10000<BR>order = 6<BR>id = 11","<B>[12]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.076<BR>confidence = 0.671<BR>coverage = 0.113<BR>lift = 7.14<BR>count = 15500<BR>order = 4<BR>id = 12","<B>[13]<\/B><BR><B>{applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;applicant_race:Information not provided,<BR>&nbsp;&nbsp;approve,<BR>&nbsp;&nbsp;aus:Desktop Underwriter}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0497<BR>confidence = 0.67<BR>coverage = 0.0741<BR>lift = 7.13<BR>count = 10100<BR>order = 5<BR>id = 13","<B>[14]<\/B><BR><B>{applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0767<BR>confidence = 0.67<BR>coverage = 0.115<BR>lift = 7.13<BR>count = 15600<BR>order = 3<BR>id = 14","<B>[15]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Information Not Provided,<BR>&nbsp;&nbsp;approve,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{Sex Not Available}<\/B><BR><BR>support = 0.0666<BR>confidence = 0.669<BR>coverage = 0.0996<BR>lift = 7.11<BR>count = 13500<BR>order = 5<BR>id = 15"],"shape":["box","box","box","box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[-0.03156205926188005,0.3235669516365347,-0.4305387559979491,1,-0.3373182608027262,0.3487589788126086,-0.1393694279327239,-0.5417277595193365,-0.3394345944222825,0.5764409114710256,0.7680858419299572,-0.4787780018194168,-0.9254834105867833,-0.008707616882215774,-0.393004403364845,-0.2668908990384286,-0.7089918948452316,-0.00536000854068408,-0.08783151907046627,0.1724091967028329,-0.6296428263490664,0.09407663174701453,-1,0.1889972182719279],"y":[-0.06493613858654013,1,-0.5646410140810987,0.6512293591377998,-0.7105705463314871,-0.7636835248250541,-1,-0.4333634323695796,-0.4996815632970063,0.7291670129859489,0.9527865534734052,-0.1447161365024012,-0.6256536842780006,-0.3470599180705616,-0.945099696045784,-0.3274891050675798,-0.8851009604915288,-0.5510176536708626,-0.817494141740303,-0.6209555297234902,-0.01276867452977648,-0.9933509706035798,-0.3037112098981194,-0.3032113782506886]},"edges":{"from":[4,2,1,3,5,8,3,5,8,1,3,5,6,8,3,5,6,8,1,3,5,7,8,3,5,7,8,1,3,5,6,7,8,3,5,6,7,8,1,3,5,6,7,1,3,8,3,5,6,7,3,8,1,3,6,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"to":[10,11,12,12,12,12,13,13,13,14,14,14,14,14,15,15,15,15,16,16,16,16,16,17,17,17,17,18,18,18,18,18,18,19,19,19,19,19,20,20,20,20,20,21,21,21,22,22,22,22,23,23,24,24,24,24,2,4,9,9,9,9,9,9,9,9,9,9,9,9,9],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":["1","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-arm-arules-vis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Visualization of top 15 rules (by lift)
</figcaption>
</figure>
</div>
</div>
<p>In <a href="#tbl-arm-by-lift" class="quarto-xref">Table&nbsp;<span>5.3</span></a> and <a href="#fig-arm-arules-vis" class="quarto-xref">Figure&nbsp;<span>5.1</span></a>, one can begin to see some interesting patterns. The rules in this list are quite interesting. Of particular interest are rules #11 and #13, establishing assoications between approval and <em>the absence</em> of ethnic, racial, and gender information on a loan application. While other features are include (e.g.&nbsp;1 bedroom home, specific underwriting systems), the association of these things together within the overarching dataset could be used to tell a compelling story.</p>
<p>Namely, with 66-70% confidence, it’s possible that you may boost your chances to have a loan approval if you omit your demographic information, as such omissions and exclusions are associated with loan approvals. Similarly speaking, if the former is a true statement, it may also be true that one may reduce their chances for approval when <em>including</em> their personal demographic information on a loan application. And by further examining these rules, both of these claims may best hold true if the loan has been processed by Rocket Mortgage.</p>
<p>From here, it’s of interest to examine association rules mined when the transactions are filtered to specific organizations. The reason for this is that, for a set threshold of support and confidence, certain interesting rules for a given organization may not be available for mining simply due to a lower volume of transactions processed via that organization. As such, by first filtering down transactions to a set organization and then exploring the rules mined for that organization at set common thresholds for support and confidence, more interesting information may arise.</p>
<!-- Navy Federal Credit Union is the only institution amongst the top 5 lenders to have an association rule for denial of African American applicants when using thresholds of 0.01 for miniumum support and confidence.  The strength of the rule, in relative terms, is moderate at best.  While the rule's lift is approximately 1.66 (thus potentially a useful rule), the confidence in this rule is only slightly above 50%.  Furthermore, we do see that the top rules for NFCU have lifts above 2.8, with much higher confidences.  Not only that, but the rules seem to be much more tightly bound to financial status of the applicant (which is highly relevant to a decision of whether or not to approve a loan).  This found rule appears to match that of CNNs findings (generally, that NFCU rejected over 50% of its Black/African American Applicants).

However, the #1 mined association rule for NFCU denials is when one's debt to income ratio exceeds the 80th percentile, when the loan to value ratio exceeds the 80th percentile, and the interest rate of the loan is between the 41st and 60th percentile, that about 96% of the time, NFCU will deny that loan.  This description sounds like a riskly loan, and it would make sense to deny on these bases!  With regard to the spectrum of NFCU rule strength, the strength of this rule at approximately 2.89 lift is substantially higher than that of the mined rule for denial of Black/African Americans.

Taking this further in context, however, suggests that, since NFCU was....

BOA appears to have issues with denying loans to White people (when...) and to people who aren't hispanic/latino (when...)

Rocket mortgage Not hispanic latino when... -->
<div class="cell">
<div id="fig-nfcu-deny-rules" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nfcu-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-0b830121bf0dd0b1ef5e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0b830121bf0dd0b1ef5e">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"label":["1 rooms","applicant_ethnicity:Not Hispanic/Latino","applicant_race:Black/African American","debt_to_income_ratio:>80","deny","income:0-20","interest_rate:41-60","loan_to_value_ratio:>80","Navy Federal Credit Union","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10"],"group":[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2],"value":[1,1,1,1,1,1,1,1,1,14.1204819277109,14.1204819277109,1,1,37.97590361445782,37.97590361445782,100,100,26.04819277108436,26.04819277108436],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE1B1B","#EE1B1B","#EE2525","#EE2525","#EED5D5","#EED5D5","#EED9D9","#EED9D9","#EEDCDC","#EEDCDC"],"title":["1 rooms","applicant_ethnicity:Not Hispanic/Latino","applicant_race:Black/African American","debt_to_income_ratio:>80","deny","income:0-20","interest_rate:41-60","loan_to_value_ratio:>80","Navy Federal Credit Union","<B>[1]<\/B><BR><B>{debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;income:0-20,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0419<BR>confidence = 0.978<BR>coverage = 0.0429<BR>lift = 2.94<BR>count = 656<BR>order = 4<BR>id = 1","<B>[2]<\/B><BR><B>{debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;income:0-20,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Navy Federal Credit Union}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0419<BR>confidence = 0.978<BR>coverage = 0.0429<BR>lift = 2.94<BR>count = 656<BR>order = 5<BR>id = 2","<B>[3]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;income:0-20,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0412<BR>confidence = 0.977<BR>coverage = 0.0422<BR>lift = 2.94<BR>count = 645<BR>order = 5<BR>id = 3","<B>[4]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;income:0-20,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Navy Federal Credit Union}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0412<BR>confidence = 0.977<BR>coverage = 0.0422<BR>lift = 2.94<BR>count = 645<BR>order = 6<BR>id = 4","<B>[5]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;applicant_race:Black/African American,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0432<BR>confidence = 0.966<BR>coverage = 0.0447<BR>lift = 2.9<BR>count = 676<BR>order = 5<BR>id = 5","<B>[6]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;applicant_race:Black/African American,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Navy Federal Credit Union}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0432<BR>confidence = 0.966<BR>coverage = 0.0447<BR>lift = 2.9<BR>count = 676<BR>order = 6<BR>id = 6","<B>[7]<\/B><BR><B>{applicant_race:Black/African American,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0465<BR>confidence = 0.966<BR>coverage = 0.0482<BR>lift = 2.9<BR>count = 728<BR>order = 4<BR>id = 7","<B>[8]<\/B><BR><B>{applicant_race:Black/African American,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Navy Federal Credit Union}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0465<BR>confidence = 0.966<BR>coverage = 0.0482<BR>lift = 2.9<BR>count = 728<BR>order = 5<BR>id = 8","<B>[9]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;loan_to_value_ratio:>80}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0425<BR>confidence = 0.965<BR>coverage = 0.0441<BR>lift = 2.9<BR>count = 666<BR>order = 5<BR>id = 9","<B>[10]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;loan_to_value_ratio:>80,<BR>&nbsp;&nbsp;Navy Federal Credit Union}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0425<BR>confidence = 0.965<BR>coverage = 0.0441<BR>lift = 2.9<BR>count = 666<BR>order = 6<BR>id = 10"],"shape":["box","box","box","box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[-0.8621198969820236,0.6101433435248478,1,-0.06449656640426149,-0.05780331039408348,-1,0.06729102321756231,0.02899167772075195,0.05723826265191678,-0.6251196494504085,-0.4836371123739438,-0.5849503754378185,-0.3829705832971577,0.5710015958288481,0.5000264626704307,0.5643186726899918,0.4088379743672612,0.04186949026088671,0.1149678382234094],"y":[1,-0.5437282994772934,0.2591204909883527,0.1503705287797519,0.01312943553426038,0.350265933290709,0.1100420165956117,-1,0.4013920219249136,-0.05305387864805022,0.2091483786985786,0.4626290964374962,0.5689716716453164,-0.1459765062844357,0.03886454956619323,0.298454540587203,0.4822378447949169,-0.508137088975621,-0.3196139354741399]},"edges":{"from":[4,6,7,4,6,7,9,1,4,6,7,1,4,6,7,9,2,3,4,7,2,3,4,7,9,3,4,7,3,4,7,9,2,4,7,8,2,4,7,8,9,10,11,12,13,14,15,16,17,18,19],"to":[10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,13,14,14,14,14,15,15,15,15,15,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,19,5,5,5,5,5,5,5,5,5,5],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":["1","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nfcu-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: top 10 NFCU Denial Rules by Lift
</figcaption>
</figure>
</div>
</div>
<p>NFCU has rules including debt-to-income ratio being above 80th percentile and loan interest rate being between 41 and 60th percentile as common features for all of its top 10 rules by lift. A total of 4 of the top ten rules include race or ethnicity (Non-hispanic/latino and black/African American applicants).</p>
<div class="cell">
<div id="fig-jpm-deny-rules" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-jpm-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-49dfa4a9d04b6d243810" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-49dfa4a9d04b6d243810">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"label":["1 rooms","aus:Desktop Underwriter","aus:Loan Prospector/Product Advisor","aus:Other","deny","interest_rate:41-60","JP Morgan","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10"],"group":[1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2],"value":[1,1,1,1,1,1,1,100,100,79.97752808988763,79.97752808988763,79.97752808988763,79.97752808988763,19.91011235955047,19.91011235955047,1,1],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE1B1B","#EE1B1B","#EE3D3D","#EE3D3D","#EE3D3D","#EE3D3D","#EECBCB","#EECBCB","#EEDCDC","#EEDCDC"],"title":["1 rooms","aus:Desktop Underwriter","aus:Loan Prospector/Product Advisor","aus:Other","deny","interest_rate:41-60","JP Morgan","<B>[1]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Other,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0482<BR>confidence = 0.451<BR>coverage = 0.107<BR>lift = 4.75<BR>count = 1970<BR>order = 4<BR>id = 1","<B>[2]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Other,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;JP Morgan}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0482<BR>confidence = 0.451<BR>coverage = 0.107<BR>lift = 4.75<BR>count = 1970<BR>order = 5<BR>id = 2","<B>[3]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0477<BR>confidence = 0.45<BR>coverage = 0.106<BR>lift = 4.74<BR>count = 1950<BR>order = 4<BR>id = 3","<B>[4]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;aus:Other,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0477<BR>confidence = 0.45<BR>coverage = 0.106<BR>lift = 4.74<BR>count = 1950<BR>order = 5<BR>id = 4","<B>[5]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;JP Morgan}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0477<BR>confidence = 0.45<BR>coverage = 0.106<BR>lift = 4.74<BR>count = 1950<BR>order = 5<BR>id = 5","<B>[6]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;aus:Other,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;JP Morgan}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0477<BR>confidence = 0.45<BR>coverage = 0.106<BR>lift = 4.74<BR>count = 1950<BR>order = 6<BR>id = 6","<B>[7]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Other,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0464<BR>confidence = 0.444<BR>coverage = 0.104<BR>lift = 4.69<BR>count = 1900<BR>order = 5<BR>id = 7","<B>[8]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Other,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;JP Morgan}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0464<BR>confidence = 0.444<BR>coverage = 0.104<BR>lift = 4.69<BR>count = 1900<BR>order = 6<BR>id = 8","<B>[9]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.046<BR>confidence = 0.444<BR>coverage = 0.104<BR>lift = 4.68<BR>count = 1880<BR>order = 5<BR>id = 9","<B>[10]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;aus:Other,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.046<BR>confidence = 0.444<BR>coverage = 0.104<BR>lift = 4.68<BR>count = 1880<BR>order = 6<BR>id = 10"],"shape":["box","box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[-0.05799996664398832,-0.09488631524715541,1,-0.4192706306464535,-0.0403592733767747,0.1616020684827955,-0.8160925450015969,-1,-0.7459687966407663,0.790316196209095,0.7079498923916734,0.2323615615384358,-0.0557231395473583,-0.3479596052625509,-0.7762885433126214,0.7128733392215811,0.3066899183977096],"y":[-1,0.2790191990976716,0.337202733858369,-0.08078716068653424,0.06798164511746974,0.1932300295802813,1,0.1862625769676101,0.5609890568880707,0.7007227570667853,0.01186858120742418,0.9274881479539956,0.691356637435135,-0.5650305532642612,-0.1340291740969981,-0.4024608156311614,-0.397764787266022]},"edges":{"from":[2,4,6,2,4,6,7,2,3,6,2,3,4,6,2,3,6,7,2,3,4,6,7,1,2,4,6,1,2,4,6,7,1,2,3,6,1,2,3,4,6,8,9,10,11,12,13,14,15,16,17],"to":[8,8,8,9,9,9,9,10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,13,14,14,14,14,15,15,15,15,15,16,16,16,16,17,17,17,17,17,5,5,5,5,5,5,5,5,5,5],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":["1","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-jpm-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: top 10 JP Morgan Denial Rules by Lift
</figcaption>
</figure>
</div>
</div>
<p>JP Morgan has the same common features of debt-to-income ratio being above 80th percentile and loan interest rate being between 41 and 60th percentile for its top 10 rules. JP Morgan has a single rule covering ethnicity for denial (non-hispanic/latino applicants with the other common criteria).</p>
<div class="cell">
<div id="fig-boa-deny-rules" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boa-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-cb83bfc779425c13ef69" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-cb83bfc779425c13ef69">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"label":["1 rooms","applicant_ethnicity:Not Hispanic/Latino","applicant_race:White","aus:Not applicable","Bank of America","debt_to_income_ratio:>80","deny","interest_rate:21-40","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10"],"group":[1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2],"value":[1,1,1,1,1,1,1,1,92.6333938294011,92.6333938294011,100,100,12.49909255898366,12.49909255898366,1,1,16.81125226860252,16.81125226860252],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE1B1B","#EE1B1B","#EE4747","#EE4747","#EEB7B7","#EEB7B7","#EED2D2","#EED2D2","#EEDCDC","#EEDCDC"],"title":["1 rooms","applicant_ethnicity:Not Hispanic/Latino","applicant_race:White","aus:Not applicable","Bank of America","debt_to_income_ratio:>80","deny","interest_rate:21-40","<B>[1]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0619<BR>confidence = 0.993<BR>coverage = 0.0623<BR>lift = 4.68<BR>count = 1480<BR>order = 5<BR>id = 1","<B>[2]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;Bank of America,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0619<BR>confidence = 0.993<BR>coverage = 0.0623<BR>lift = 4.68<BR>count = 1480<BR>order = 6<BR>id = 2","<B>[3]<\/B><BR><B>{aus:Not applicable,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0636<BR>confidence = 0.993<BR>coverage = 0.0641<BR>lift = 4.68<BR>count = 1520<BR>order = 4<BR>id = 3","<B>[4]<\/B><BR><B>{aus:Not applicable,<BR>&nbsp;&nbsp;Bank of America,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0636<BR>confidence = 0.993<BR>coverage = 0.0641<BR>lift = 4.68<BR>count = 1520<BR>order = 5<BR>id = 4","<B>[5]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0433<BR>confidence = 0.991<BR>coverage = 0.0437<BR>lift = 4.67<BR>count = 1040<BR>order = 6<BR>id = 5","<B>[6]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;Bank of America,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0433<BR>confidence = 0.991<BR>coverage = 0.0437<BR>lift = 4.67<BR>count = 1040<BR>order = 7<BR>id = 6","<B>[7]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_race:White,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0406<BR>confidence = 0.991<BR>coverage = 0.041<BR>lift = 4.67<BR>count = 974<BR>order = 6<BR>id = 7","<B>[8]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_race:White,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;Bank of America,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0406<BR>confidence = 0.991<BR>coverage = 0.041<BR>lift = 4.67<BR>count = 974<BR>order = 7<BR>id = 8","<B>[9]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0443<BR>confidence = 0.991<BR>coverage = 0.0447<BR>lift = 4.67<BR>count = 1060<BR>order = 5<BR>id = 9","<B>[10]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;aus:Not applicable,<BR>&nbsp;&nbsp;Bank of America,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0443<BR>confidence = 0.991<BR>coverage = 0.0447<BR>lift = 4.67<BR>count = 1060<BR>order = 6<BR>id = 10"],"shape":["box","box","box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[-0.1166751369925724,0.8607883043208917,-1,0.3711969325332676,-0.613011678082408,0.4565517657076634,0.2421324827354134,0.152634430337504,0.478088067506681,-0.4200986082140434,0.9937328936676397,0.3493325898013373,0.8757514481658382,-0.03499173242556797,-0.1345919223513462,-0.5260682410270339,1,0.1348114005955148],"y":[0.2979617257507767,-1,1,0.08126314404462032,-0.7160268294794636,-0.09156304089429168,-0.1795754857926712,9.850018561929907e-05,0.5829196289234635,-0.1938547362867388,0.3357662727665696,-0.6443327867809264,-0.1495448107523628,-0.5091056312914551,0.6262030902442934,0.1729914572877909,-0.4523261893254538,-0.7912092381137659]},"edges":{"from":[1,4,6,8,1,4,5,6,8,4,6,8,4,5,6,8,1,2,4,6,8,1,2,4,5,6,8,1,3,4,6,8,1,3,4,5,6,8,2,4,6,8,2,4,5,6,8,9,10,11,12,13,14,15,16,17,18],"to":[9,9,9,9,10,10,10,10,10,11,11,11,12,12,12,12,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,18,18,18,18,18,7,7,7,7,7,7,7,7,7,7],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":["1","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boa-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: top 10 Bank of America Denial Rules by Lift
</figcaption>
</figure>
</div>
</div>
<p>Bank of America appears as an oddity here. The main common traits are a moderate interest rate (in the range of 21st to 40th percentile) and the lack of use of an underwriting system (e.g.&nbsp;they didn’t use any underwriting).</p>
<p>Surprisingly, there are strong rules for BoA for denial of White and Non-hispanic/latino applicants.</p>
<div class="cell">
<div id="fig-wf-deny-rules" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wf-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-25f8dfd1dfbfa0fd1db3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-25f8dfd1dfbfa0fd1db3">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"label":["1 rooms","aus:Desktop Underwriter","aus:Internal Proprietary","aus:Loan Prospector/Product Advisor","debt_to_income_ratio:>80","deny","interest_rate:21-40","Wells Fargo","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10"],"group":[1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2],"value":[1,1,1,1,1,1,1,1,100,100,53.10526315789473,53.10526315789473,53.10526315789473,53.10526315789473,47.89473684210526,47.89473684210526,1,1],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE1B1B","#EE1B1B","#EE8E8E","#EE8E8E","#EE8E8E","#EE8E8E","#EE9B9B","#EE9B9B","#EEDCDC","#EEDCDC"],"title":["1 rooms","aus:Desktop Underwriter","aus:Internal Proprietary","aus:Loan Prospector/Product Advisor","debt_to_income_ratio:>80","deny","interest_rate:21-40","Wells Fargo","<B>[1]<\/B><BR><B>{aus:Internal Proprietary,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0602<BR>confidence = 0.989<BR>coverage = 0.0609<BR>lift = 6.2<BR>count = 1560<BR>order = 5<BR>id = 1","<B>[2]<\/B><BR><B>{aus:Internal Proprietary,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40,<BR>&nbsp;&nbsp;Wells Fargo}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0602<BR>confidence = 0.989<BR>coverage = 0.0609<BR>lift = 6.2<BR>count = 1560<BR>order = 6<BR>id = 2","<B>[3]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0595<BR>confidence = 0.989<BR>coverage = 0.0602<BR>lift = 6.2<BR>count = 1540<BR>order = 5<BR>id = 3","<B>[4]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Internal Proprietary,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0595<BR>confidence = 0.989<BR>coverage = 0.0602<BR>lift = 6.2<BR>count = 1540<BR>order = 6<BR>id = 4","<B>[5]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40,<BR>&nbsp;&nbsp;Wells Fargo}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0595<BR>confidence = 0.989<BR>coverage = 0.0602<BR>lift = 6.2<BR>count = 1540<BR>order = 6<BR>id = 5","<B>[6]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Internal Proprietary,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40,<BR>&nbsp;&nbsp;Wells Fargo}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0595<BR>confidence = 0.989<BR>coverage = 0.0602<BR>lift = 6.2<BR>count = 1540<BR>order = 7<BR>id = 6","<B>[7]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Internal Proprietary,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0595<BR>confidence = 0.989<BR>coverage = 0.0601<BR>lift = 6.2<BR>count = 1540<BR>order = 6<BR>id = 7","<B>[8]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Internal Proprietary,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40,<BR>&nbsp;&nbsp;Wells Fargo}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0595<BR>confidence = 0.989<BR>coverage = 0.0601<BR>lift = 6.2<BR>count = 1540<BR>order = 7<BR>id = 8","<B>[9]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0588<BR>confidence = 0.989<BR>coverage = 0.0594<BR>lift = 6.19<BR>count = 1520<BR>order = 6<BR>id = 9","<B>[10]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;aus:Internal Proprietary,<BR>&nbsp;&nbsp;aus:Loan Prospector/Product Advisor,<BR>&nbsp;&nbsp;debt_to_income_ratio:>80,<BR>&nbsp;&nbsp;interest_rate:21-40}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0588<BR>confidence = 0.989<BR>coverage = 0.0594<BR>lift = 6.19<BR>count = 1520<BR>order = 7<BR>id = 10"],"shape":["box","box","box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[-1,0.2955804139055087,-0.5223275013444879,-0.1713348777550472,0.05587901563906339,0.0406210672498053,-0.2198047597224994,1,-0.3793834598337952,0.2167968910893536,0.5688858884541821,-0.3826088081040457,0.7152459562099283,0.4527842604323893,-0.8917531429397562,0.05370692491041229,-0.2743658819339096,-0.6523251628000813],"y":[-1,-0.9743442823230262,0.4911407583255532,0.2325029146310948,0.1968569845419337,-0.08477434627032987,-0.04950863623493706,0.579556186305334,1,0.9205436862918415,-0.5390958250075997,-0.5507261003590622,-0.08664440400814277,0.2897502011424826,0.07515644088543483,-0.4173205629822304,-0.9515286188872472,-0.381243885711006]},"edges":{"from":[3,4,5,7,3,4,5,7,8,2,4,5,7,2,3,4,5,7,2,4,5,7,8,2,3,4,5,7,8,1,3,4,5,7,1,3,4,5,7,8,1,2,4,5,7,1,2,3,4,5,7,9,10,11,12,13,14,15,16,17,18],"to":[9,9,9,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,18,6,6,6,6,6,6,6,6,6,6],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":["1","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wf-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: top 10 Wells Fargo Denial Rules by Lift
</figcaption>
</figure>
</div>
</div>
<p>Wells Fargo corporation has no presence of association rules tied to ethnic, racial, gender, or age in its top-10 rules. Their denials seem to be predominantly mapped to lower proposed interest rates married with a high debt-to-income ratio.</p>
<div class="cell">
<div id="fig-rm-deny-rules" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rm-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-5c061c4234e6c91b3fe1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5c061c4234e6c91b3fe1">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"label":["1 rooms","applicant_ethnicity:Not Hispanic/Latino","aus:Desktop Underwriter","deny","interest_rate:41-60","Rocket Mortgage","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10"],"group":[1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2],"value":[1,1,1,1,1,1,100,18.98777838131449,18.98777838131449,95.85931558935359,95.85931558935359,16.91743617599131,16.91743617599131,3.258555133079832,3.258555133079832,1],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE1B1B","#EE2B2B","#EE2B2B","#EE3131","#EE3131","#EE3A3A","#EE3A3A","#EED2D2","#EED2D2","#EEDCDC"],"title":["1 rooms","applicant_ethnicity:Not Hispanic/Latino","aus:Desktop Underwriter","deny","interest_rate:41-60","Rocket Mortgage","<B>[1]<\/B><BR><B>{interest_rate:41-60,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0931<BR>confidence = 0.388<BR>coverage = 0.24<BR>lift = 3.39<BR>count = 9020<BR>order = 3<BR>id = 1","<B>[2]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.062<BR>confidence = 0.387<BR>coverage = 0.16<BR>lift = 3.37<BR>count = 6000<BR>order = 3<BR>id = 2","<B>[3]<\/B><BR><B>{aus:Desktop Underwriter,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.062<BR>confidence = 0.387<BR>coverage = 0.16<BR>lift = 3.37<BR>count = 6000<BR>order = 4<BR>id = 3","<B>[4]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0915<BR>confidence = 0.386<BR>coverage = 0.237<BR>lift = 3.36<BR>count = 8860<BR>order = 3<BR>id = 4","<B>[5]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0915<BR>confidence = 0.386<BR>coverage = 0.237<BR>lift = 3.36<BR>count = 8860<BR>order = 4<BR>id = 5","<B>[6]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0612<BR>confidence = 0.385<BR>coverage = 0.159<BR>lift = 3.35<BR>count = 5930<BR>order = 4<BR>id = 6","<B>[7]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;aus:Desktop Underwriter,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0612<BR>confidence = 0.385<BR>coverage = 0.159<BR>lift = 3.35<BR>count = 5930<BR>order = 5<BR>id = 7","<B>[8]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0559<BR>confidence = 0.361<BR>coverage = 0.155<BR>lift = 3.15<BR>count = 5420<BR>order = 3<BR>id = 8","<B>[9]<\/B><BR><B>{applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;interest_rate:41-60,<BR>&nbsp;&nbsp;Rocket Mortgage}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0559<BR>confidence = 0.361<BR>coverage = 0.155<BR>lift = 3.15<BR>count = 5420<BR>order = 4<BR>id = 9","<B>[10]<\/B><BR><B>{1 rooms,<BR>&nbsp;&nbsp;applicant_ethnicity:Not Hispanic/Latino,<BR>&nbsp;&nbsp;interest_rate:41-60}<\/B><BR>&nbsp;&nbsp; => <B>{deny}<\/B><BR><BR>support = 0.0551<BR>confidence = 0.359<BR>coverage = 0.154<BR>lift = 3.13<BR>count = 5340<BR>order = 4<BR>id = 10"],"shape":["box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[0.9822625111383398,0.3894247794453078,-0.4110437801532451,0.02186987132914919,-0.1299597109247006,-0.6751002983994834,-1,-0.550633535734731,-0.8596642221419247,1,0.3894004649908143,0.3757161518915582,-0.025602726542437,0.1571239251648608,-0.3560566445260163,0.715916172215517],"y":[-0.3545999820336855,1,-1,0.01792638912787714,-0.05349182942946151,-0.03147956294295795,0.2559487426282243,-0.6307176186716679,-0.4195499055066357,9.785739808920724e-05,-0.2012223148991248,-0.6628858699108404,-0.4969013774444598,0.6379807378344082,0.5393595957060577,0.3548696391368464]},"edges":{"from":[5,6,3,5,3,5,6,1,5,1,5,6,1,3,5,1,3,5,6,2,5,2,5,6,1,2,5,7,8,9,10,11,12,13,14,15,16],"to":[7,7,8,8,9,9,9,10,10,11,11,11,12,12,12,13,13,13,13,14,14,15,15,15,16,16,16,4,4,4,4,4,4,4,4,4,4],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":["1","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rm-deny-rules-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: top 10 Rocket Mortgage Denial Rules by Lift
</figcaption>
</figure>
</div>
</div>
<p>Wells Fargo has 3 rules in its top 10 by lift tied to ethnicity (Denial of non-Hispanic/Latino applicants with moderate interest rates).</p>
</section>
<section id="conclusions" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="conclusions"><span class="header-section-number">5.6</span> Conclusions</h2>
<!-- * How is this relevant to the topic? -->
<p>These association rules support this research going a degree beyond basic statistical analyses of source variables. In particular, cases of lift being over 1 are of interest, as it suggests that the antecedents contribute more probabilistically to the precedents. Once again, not necessarily tending to causation, but instead establishing a probabilistic and associative connection between the variables.</p>
<p>Examining the results for the top 15 rules by lift, one sees an interesting occurence. Namely, the following set of items is frequent and strongly associated (examining the 11th rule):</p>
<p>{ 1 rooms, applicant_ethnicity:Information Not Provided, applicant_race:Information not provided approve, aus:Desktop Underwriter} =&gt; {Sex Not Available}</p>
<p>Namely, that mortgage approval is strongly associated with not having protected class information (sex, ethnicity, race) available or listed on a mortgage application.</p>
<p>With lift values exceeding 7 and confidence of 66%. Moreover, this 66% confidence corresponds to the concept that when all items in the antecedent are met, 66% of the time it is followed by the sex not being listed or available in the application.</p>
<p>This suggests, then, that it is quite likely to see applications where no demographic protected class information is provided or available for the applicant, and the application is not denied. This finding appears connected and linked to those of <a href="data.html#fig-rc-app-lend" class="quarto-xref">Figure&nbsp;<span>2.9</span></a>, <a href="data.html#fig-sex-inst" class="quarto-xref">Figure&nbsp;<span>2.10</span></a>, and <a href="data.html#fig-age-lender" class="quarto-xref">Figure&nbsp;<span>2.11</span></a>. What is further interesting is that the findings for each individual chart in initial exploration appear to merge together as rules within this association rule mining. While ARM does not establish or produce causal relationsips, the further depth of the relationships between these protected class variables is intriguing.</p>
<p>However, some potentially concerning rules did arise for rocket mortgage (male or White or non-hispanic/latino), Wells Fargo (non-hispanic/latino ethnicity), Bank of America (White or non-hispanic/latino), and JP Morgan (non-Hispanic/Latino). While these rules appear to include other relevant financial or risk-based lending information (high debt to income ratio and insufficient interest rate on the loan, and other similar financial indicators that the applicant’s ability to repay may be at risk), these rules suggest that, at least on a frequentist basis, all lenders are more likely to deny loans to non-Hispanic/Latino applicants when they fall within these financial categories.</p>
<p>The findings in denial for NFCU rules #7 and #8 in <a href="#fig-nfcu-deny-rules" class="quarto-xref">Figure&nbsp;<span>5.2</span></a> high confidence and lift are consistent with the findings of CNN’s report from the end of 2023, when taking the organization by itself and when not comparing to other institutions. To compare all institutions for such a rule of denial of black applicants, here, ARM is run once more, focused across the entirety of the dataset with minimum support = 0.04, confidence = 0.01, and setting loan denial as the consequent.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    lhs                                           rhs       support confidence  coverage      lift count
[1] {applicant_race:White,                                                                              
     interest_rate:41-60}                      =&gt; {deny} 0.04213514  0.3407446 0.1236561 2.3546500  8567
[2] {1 rooms,                                                                                           
     applicant_race:White,                                                                              
     interest_rate:41-60}                      =&gt; {deny} 0.04138263  0.3381153 0.1223921 2.3364812  8414
[3] {applicant_race:White}                     =&gt; {deny} 0.07539273  0.1235273 0.6103324 0.8536119 15329
[4] {1 rooms,                                                                                           
     applicant_race:White}                     =&gt; {deny} 0.07414348  0.1224923 0.6052911 0.8464593 15075
[5] {applicant_race:White,                                                                              
     aus:Desktop Underwriter}                  =&gt; {deny} 0.04111213  0.1185674 0.3467406 0.8193371  8359
[6] {1 rooms,                                                                                           
     applicant_race:White,                                                                              
     aus:Desktop Underwriter}                  =&gt; {deny} 0.04052193  0.1176227 0.3445077 0.8128092  8239
[7] {applicant_ethnicity:Not Hispanic/Latino,                                                           
     applicant_race:White}                     =&gt; {deny} 0.05616707  0.1111652 0.5052577 0.7681857 11420
[8] {1 rooms,                                                                                           
     applicant_ethnicity:Not Hispanic/Latino,                                                           
     applicant_race:White}                     =&gt; {deny} 0.05537030  0.1103444 0.5017952 0.7625140 11258</code></pre>
</div>
</div>
<p>In the above table, all rules from the totality of the dataset that include race are listed. Examining these rules, one can clearly see that at the selected minimum confidence and support levels, there are no stand-outs in terms of specific organizations having high-lift high-confidence associations between a particular protected class and denial of loan applications. One can also see, however, that with limited confidence and moderate lift in rules #1 and #2, White applicants whose interest rates would be in the 41-60th percentile of 2023 interest rates tended to be denied. The remainder of the rules are not useful as they have lift values less than 1 and thus have negative assoications with one another.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     lhs                                           rhs          support confidence   coverage     lift count
[1]  {applicant_race:White,                                                                                 
      interest_rate:&gt;80}                        =&gt; {approve} 0.11876236          1 0.11876236 1.169203 24147
[2]  {applicant_race:White,                                                                                 
      interest_rate:&gt;80,                                                                                    
      Joint}                                    =&gt; {approve} 0.04705836          1 0.04705836 1.169203  9568
[3]  {applicant_race:White,                                                                                 
      interest_rate:&gt;80,                                                                                    
      Male}                                     =&gt; {approve} 0.04324667          1 0.04324667 1.169203  8793
[4]  {applicant_race:White,                                                                                 
      aus:Loan Prospector/Product Advisor,                                                                  
      interest_rate:&gt;80}                        =&gt; {approve} 0.05488339          1 0.05488339 1.169203 11159
[5]  {applicant_race:White,                                                                                 
      interest_rate:&gt;80,                                                                                    
      Rocket Mortgage}                          =&gt; {approve} 0.06145424          1 0.06145424 1.169203 12495
[6]  {applicant_race:White,                                                                                 
      aus:Desktop Underwriter,                                                                              
      interest_rate:&gt;80}                        =&gt; {approve} 0.08051760          1 0.08051760 1.169203 16371
[7]  {applicant_ethnicity:Not Hispanic/Latino,                                                              
      applicant_race:White,                                                                                 
      interest_rate:&gt;80}                        =&gt; {approve} 0.09885305          1 0.09885305 1.169203 20099
[8]  {1 rooms,                                                                                              
      applicant_race:White,                                                                                 
      interest_rate:&gt;80}                        =&gt; {approve} 0.11780329          1 0.11780329 1.169203 23952
[9]  {applicant_race:White,                                                                                 
      interest_rate:0-20,                                                                                   
      Rocket Mortgage}                          =&gt; {approve} 0.05066840          1 0.05066840 1.169203 10302
[10] {1 rooms,                                                                                              
      applicant_race:White,                                                                                 
      interest_rate:&gt;80,                                                                                    
      Joint}                                    =&gt; {approve} 0.04677802          1 0.04677802 1.169203  9511</code></pre>
</div>
</div>
<p>Since metrics such as confidence and lift originate from somewhat Bayesian probability measurements, the performance of naive Bayes and Bernoulli Naive Bayes classification methods on the data could potentially be effective in terms of accuracy, recall, and precision for cases when age, gender, or race are not listed for an application. What would still remain in question is the degree to which predictive strength for those models is impacted by the presence of specific protected classes (instead of their absence) for establishing a link to the outcome of approval or denial of the application.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./clustering.html" class="pagination-link  aria-label=" &lt;span="" clustering&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Clustering</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>